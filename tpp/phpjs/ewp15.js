/**
 * JavaScript for PHPMaker 2019
 * @license (C)2002-2019 e.World Technology Ltd.
 */
var currentPageID,currentForm,currentSearchForm,currentAdvancedSearchForm,$rowindex$=null;var ew={LANGUAGE_ID:"",PAGE_ID:"",DATE_SEPARATOR:"",TIME_SEPARATOR:"",DATE_FORMAT:"",DATE_FORMAT_ID:0,DATETIME_WITHOUT_SECONDS:false,DECIMAL_POINT:"",THOUSANDS_SEP:"",MIN_PASSWORD_STRENGTH:0,GENERATE_PASSWORD_LENGTH:0,GENERATE_PASSWORD_UPPERCASE:true,GENERATE_PASSWORD_LOWERCASE:true,GENERATE_PASSWORD_NUMBER:true,GENERATE_PASSWORD_SPECIALCHARS:false,SESSION_TIMEOUT:0,SESSION_TIMEOUT_COUNTDOWN:0,SESSION_KEEP_ALIVE_INTERVAL:0,RELATIVE_PATH:"",IS_LOGGEDIN:false,IS_SYS_ADMIN:false,CURRENT_USER_NAME:"",IS_AUTOLOGIN:false,TIMEOUT_URL:"",API_URL:"",API_ACTION_NAME:"",API_OBJECT_NAME:"",API_FIELD_NAME:"",API_KEY_NAME:"",API_LIST_ACTION:"",API_VIEW_ACTION:"",API_ADD_ACTION:"",API_EDIT_ACTION:"",API_DELETE_ACTION:"",API_LOGIN_ACTION:"",API_FILE_ACTION:"",API_UPLOAD_ACTION:"",API_JQUERY_UPLOAD_ACTION:"",API_SESSION_ACTION:"",API_LOOKUP_ACTION:"",API_LOOKUP_TABLE:"",API_PROGRESS_ACTION:"",LOOKUP_FILTER_VALUE_SEPARATOR:"",AUTO_SUGGEST_MAX_ENTRIES:0,MAX_EMAIL_RECIPIENT:0,DISABLE_BUTTON_ON_SUBMIT:false,IMAGE_FOLDER:"",UPLOAD_URL:"",UPLOAD_TYPE:"",UPLOAD_THUMBNAIL_WIDTH:0,UPLOAD_THUMBNAIL_HEIGHT:0,MULTIPLE_UPLOAD_SEPARATOR:"",IMPORT_FILE_ALLOWED_EXT:"",USE_COLORBOX:false,USE_JAVASCRIPT_MESSAGE:false,PROJECT_STYLESHEET_FILENAME:null,PDF_STYLESHEET_FILENAME:null,ANTIFORGERY_TOKEN:null,CSS_FLIP:false,RESET_HEIGHT:false,DEBUG_ENABLED:false,CONFIRM_CANCEL:true,SEARCH_FILTER_OPTION:null,OPTION_HTML_TEMPLATE:"",TABLE_CLASSNAME:"ew-table",GRID_CLASSNAME:"ew-grid",MULTI_COLUMN_GRID_CLASSNAME:"ew-multi-column-grid",TABLE_ROW_CLASSNAME:"ew-table-row",TABLE_ALT_ROW_CLASSNAME:"ew-table-alt-row",ITEM_TEMPLATE_CLASSNAME:"ew-template",ITEM_TABLE_CLASSNAME:"ew-item-table",TABLE_LAST_COL_CLASSNAME:"ew-table-last-col",TABLE_LAST_ROW_CLASSNAME:"ew-table-last-row",TABLE_PREVIEW_ROW_CLASSNAME:"ew-table-preview-row",TABLE_EDIT_ROW_CLASSNAME:"ew-table-edit-row",TABLE_SELECT_ROW_CLASSNAME:"ew-table-select-row",TABLE_HIGHLIGHT_ROW_CLASSNAME:"ew-table-highlight-row",TABLE_BORDER_BOTTOM_CLASSNAME:"ew-table-border-bottom",REPORT_CONTAINER_ID:"ew-container",ROWTYPE_ADD:2,ROWTYPE_EDIT:3,UNFORMAT_YEAR:50,LAZY_LOAD:false,LAZY_LOAD_DELAY:50,AJAX_DELAY:10,LOOKUP_DELAY:250,MAX_OPTION_COUNT:3,SHOW_EXPORT_DIALOG:true,language:null,vars:null,googleMaps:[],addOptionDialog:null,emailDialog:null,importDialog:null,modalDialog:null,modalLookupDialog:null,lightboxSettings:{transition:"none",photo:true,opacity:.5},importUploadOptions:{maxFileSize:1e7,maxNumberOfFiles:10},IS_SCREEN_SM_MIN:window.matchMedia&&window.matchMedia("(min-width: 768px)").matches||!window.matchMedia&&$(window).width()>=768,MOBILE_DETECT:new MobileDetect(window.navigator.userAgent)};jQuery.extend(ew,function(e,t){var a=e(document);var i=!!t.MOBILE_DETECT.mobile();var r={highlight:true,hint:true,minLength:1,limit:10,trigger:"click",delay:0,templates:{footer:'<div class="tt-footer"><a href="#" class="tt-more"></a></div>'}};var n=function(t){var a=e.isString(t)?t:b(t).id;return arguments.callee[a]};function s(){var e=r;e.limit=t.AUTO_SUGGEST_MAX_ENTRIES;return e}function l(e){r=e}function o(a){var i=a&&a.target?a.target:document;e(i).find(".ew-icon").closest("a, button").add(".ew-tooltip").tooltip({container:"body",trigger:t.IS_MOBILE?"manual":"hover",placement:"bottom"})}function d(a){var i=a&&a.target?a.target:document;var r=function(e){return t.language.phrase("CurrentPassword")+e};if(e.fn.pStrength&&typeof t.MIN_PASSWORD_STRENGTH!="undefined"){e(i).find(".ew-password-strength").each(function(){var a=e(this);if(!a.data("pStrength"))a.pStrength({changeBackground:false,backgrounds:[],passwordValidFrom:t.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(a,i){var r=e(this),n=e("[id='"+r.attr("data-password-strength")+"']"),s=n.find(".progress-bar");if(r.val()){var l=i+"%";if(i<25){s.addClass("bg-danger").removeClass("bg-warning bg-info bg-success")}else if(i<50){s.addClass("bg-warning").removeClass("bg-danger bg-info bg-success")}else if(i<75){s.addClass("bg-info").removeClass("bg-danger bg-warning bg-success")}else{s.addClass("bg-success").removeClass("bg-danger bg-warning bg-info")}s.css("width",l);if(i>25)l=t.language.phrase("PasswordStrength").replace("%p",l);s.html(l);n.removeClass("d-none").show();r.data("validated",i>=t.MIN_PASSWORD_STRENGTH)}else{n.addClass("d-none").hide();r.data("validated",false)}}}).on("keyup change",function(){var t=e(this),a=e("#"+t.data("password-generated"));if(a.is(":visible")){a.toggle(!!t.val());a.html(r(t.val()))}})})}if(e.fn.pGenerator){e(i).find(".ew-password-generator").each(function(){var a=e(this);if(!a.data("pGenerator"))a.pGenerator({passwordLength:t.GENERATE_PASSWORD_LENGTH,uppercase:t.GENERATE_PASSWORD_UPPERCASE,lowercase:t.GENERATE_PASSWORD_LOWERCASE,numbers:t.GENERATE_PASSWORD_NUMBER,specialChars:t.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(t){var a=e(this);e("#"+a.attr("data-password-field")).val(t).change().focus().triggerHandler("click");e("#"+a.attr("data-password-confirm")).val(t);e("#"+a.attr("data-password-strength")).addClass("d-none").hide();e("#"+a.attr("data-password-generated")).html(r(t)).removeClass("d-none").show()}})})}}function f(){var a,i,r,n,s,l=e("#ew-timer"),o=t.SESSION_KEEP_ALIVE_INTERVAL>0||t.IS_LOGGEDIN&&t.IS_AUTOLOGIN;var d=function(){var a=t.API_URL+"?"+t.API_ACTION_NAME+"="+t.API_SESSION_ACTION+"&rnd="+Et();a+="&token="+t.ANTIFORGERY_TOKEN;e.get(a,function(a){t.ANTIFORGERY_TOKEN=a;e("input:hidden[name=token]").val(a)})};l.find(".modal-footer .btn-primary").click(function(e){if(r)r.cancel();l.modal("hide");d();if(!o&&t.SESSION_TIMEOUT>0)c()});var f=function(){s=t.SESSION_TIMEOUT_COUNTDOWN;a=t.SESSION_TIMEOUT-t.SESSION_TIMEOUT_COUNTDOWN;if(a<0){a=0;s=t.SESSION_TIMEOUT}if(r)r.cancel();if(i)i.cancel()};var u=function(){if(n)n.cancel();r=e.later(1e3,null,function(){if(s>0){l.find(".modal-body").html('<p class="text-danger">'+t.language.phrase("SessionWillExpire").replace("%s",s)+"</p>");l.modal("show")}else{l.find(".modal-body").html('<p class="text-danger">'+t.language.phrase("SessionExpired")+"</p>");f();e.later(1e3,null,function(){l.modal("hide");window.location=t.TIMEOUT_URL+"?expired=1"})}s--},null,true)};var c=function(){f();i=e.later(a*1e3,null,u)};if(o){var p=t.SESSION_KEEP_ALIVE_INTERVAL>0?t.SESSION_KEEP_ALIVE_INTERVAL:t.SESSION_TIMEOUT-t.SESSION_TIMEOUT_COUNTDOWN;if(p<=0)p=60;n=e.later(p*1e3,null,d,null,true)}else{if(t.SESSION_TIMEOUT>0)c()}}function u(t){var a=t&&t.target?t.target:document;e(a).find(".ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").click(function(t){var a,i=e(this),r=i.attr("href");if(r)p(r);t.preventDefault()})}function c(t){var a=t&&t.target?t.target:document;var i=e(a).find("input[type=checkbox].ew-multi-select");i.click(function(t){var a=this.name.split("_")[0],r=i.filter("[name^='"+a+"_']"),n=r.length,s=r.filter(":checked").length;e(this.form).find("input[type=checkbox]#"+a).prop("checked",s==n).prop("indeterminate",s!=n&&s!=0)})}function p(e,i){var r,n=window.location!=window.parent.location&&window.parent.jQuery?window.parent.jQuery:jQuery;n("body").css("cursor","wait");if(t.SHOW_EXPORT_DIALOG){r=n("#ew-message-box");r.find(".modal-body").html("<p>"+t.language.phrase("Exporting")+"</p>");r.find(".modal-footer button").prop("disabled",true);r.modal("show")}var s=i?"POST":"GET";n.fileDownload(e,{httpMethod:s,data:i||null,successCallback:function(e){if(t.SHOW_EXPORT_DIALOG)r.modal("hide");a.trigger("export",[{type:"done",url:e}])},failCallback:function(e,i){if(t.SHOW_EXPORT_DIALOG)r.find(".modal-body").html("<div class='text-danger'><h4>"+t.language.phrase("FailedToExport")+"</h4>"+e+"</div>");a.trigger("export",[{type:"fail",url:i}])}}).always(function(){if(t.SHOW_EXPORT_DIALOG)r.find(".modal-footer button").prop("disabled",false);n("body").css("cursor","default");a.trigger("export",[{type:"always",url:e}])})}function h(i){if(!t.LAZY_LOAD)return;var r=i&&i.target?i.target:document,n=e(r).find("img.ew-lazy"),s=n.length;n.each(function(i){var r=this;e.later(i*t.LAZY_LOAD_DELAY,null,function(){var t=e(r),n=t.data("src");if(n)t.prop("src",n);if(i==s-1)a.trigger("lazyload")})})}function g(a){var i=a&&a.target?a.target:document;e.extend(t.lightboxSettings,{title:t.language.phrase("LightboxTitle"),current:t.language.phrase("LightboxCurrent"),previous:t.language.phrase("LightboxPrevious"),next:t.language.phrase("LightboxNext"),close:t.language.phrase("LightboxClose"),xhrError:t.language.phrase("LightboxXhrError"),imgError:t.language.phrase("LightboxImgError")});e(i).find(".ew-lightbox").each(function(){var a=e(this);a.colorbox(e.extend({rel:a.data("rel")},t.lightboxSettings))})}function v(t){var a=t&&t.target?t.target:document,i=e(a);i.find("input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]").each(function(){var t=e(this);t.tooltip(e.extend({html:true,placement:"bottom"},t.data()))});i.find("a.ew-tooltip-link").each(je);i.find(".ew-tooltip").tooltip({placement:"bottom"});i.find(".ew-popover").popover()}function m(i,r){var l=this,o=false;this.id=i;this.pageId=r;this.$element=null;this._form=null;this.initSearchPanel=false;this.modified=false;this.validateRequired=true;this.validate=null;this.emptyRow=null;this.multiPage=null;this.autoSuggests={};this.searchOperatorChanged=function(t){var a=this.getForm(),i=e(a),r=e.isString(t)?a.elements[t]:t;if(!r)return;var n=r.id.substr(2),s=e(r).val(),l=s=="BETWEEN",o=s=="IS NULL"||s=="IS NOT NULL";if(/^z_/.test(r.id))i.find("[name^=x_"+n+"],[name^=cal_x_"+n+"]").prop("disabled",o);if(/^w_/.test(r.id))i.find("[name^=y_"+n+"],[name^=cal_y_"+n+"]").prop("disabled",o);i.find("span.btw0_"+n).toggleClass("d-none",l).end().find("span.btw1_"+n).toggleClass("d-none",!l).find(":input").prop("disabled",!l).end().find(":button").toggleClass("disabled",!l).prop("disabled",!l)};this.disableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;var a=this.getForm();e(a).find(":submit:not(.dropdown-toggle)").prop("disabled",true).addClass("disabled")};this.enableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;var a=this.getForm();e(a).find(":submit:not(.dropdown-toggle)").prop("disabled",false).removeClass("disabled")};this.appendHidden=function(t){var a=this.getForm(),i=e(a),r=e(t).closest(".ew-form"),n=r.attr("id")+"$"+t.name;if(i.find("input:hidden[name='"+n+"']")[0])return;var s=r.find('[name="'+t.name+'"]').serializeArray();if(s.length){e.each(s,function(t,a){e('<input type="hidden" name="'+n+'">').val(a.value).appendTo(i)})}else{e('<input type="hidden" name="'+n+'">').val("").appendTo(i)}};this.canSubmit=function(){var t=this.getForm(),a=e(t);this.disableForm();this.updateTextArea();this.postAutoSuggest();if(!this.validate||this.validate()&&!a.find(".is-invalid")[0]){a.find("input[name^=sv_], .ew-template input").prop("disabled",true);a.find("[data-readonly=1][disabled]").prop("disabled",false);var i=e(a.find("input[name='detailpage']").map(function(e,t){return a.find("#"+t.value).get()}));if(i.length>1){i.each(function(t,a){e(a).find(":input").each(function(e,t){if(/^(fn_)?(x|o)\d*_/.test(t.name)){var r=i.not(a).find(":input[name='"+t.name+"']");if(r.length){l.appendHidden(t);r.each(function(){l.appendHidden(this)})}}})})}return true}else{this.enableForm()}return false};this.submit=function(e){var t=this.getForm();if(this.canSubmit()){if(e)t.action=e;t.submit()}return false};this.lists=function(e){e=e.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");return this.lists[e]};this.compileTemplates=function(){for(var t in this.lists){var a=this.lists[t];if(a.template&&e.isString(a.template))a.template=e.templates(a.template)}};this.getForm=function(){if(!this._form){this.$element=e("#"+this.id);if(this.$element.is("form")){this._form=this.$element[0]}else if(this.$element.is("div")){this._form=this.$element.closest("form")[0]}}return this._form};this.getElement=function(t){if(!this.$element)this.$element=e("#"+this.id);return t?fe(t,this.$element):this.$element[0]};this.getElements=function(t){if(!this.$element)this.$element=e("#"+this.id);var a="[name='"+t+"']";a="input"+a+",select"+a+",textarea"+a+",button"+a;var i=this.$element.find(a);return i.length==0?null:i.length==1&&i.is(":not([type=checkbox]):not([type=radio])")?i[0]:i.get()};this.postAutoSuggest=function(){for(var e in this.autoSuggests){var t=this.autoSuggests[e].$input;if(t&&t.is(":focus")){t.blur();break}}};this.updateLists=function(a){if(a===$rowindex$)return;var i=[],r=this.getForm();this.compileTemplates();for(var n in this.lists){var s=this.lists[n].parentFields.slice();var l=this.lists[n].ajax;if(e.isValue(a)){n=n.replace(/^x_/,"x"+a+"_");for(var o=0,d=s.length;o<d;o++)s[o]=s[o].replace(/^x_/,"x"+a+"_")}if(e.isBoolean(l)){var f=[];for(var o=0,d=s.length;o<d;o++)f[f.length]=ve(s[o],r);i[i.length]=[n,f,l,false]}else{S.call(this,n,s,null,false)}}for(var o=0,u=i.length;o<u;o++)e.later(t.AJAX_DELAY*o,this,S,i[o])};this.createAutoSuggest=function(t){var a=t.id;t.form=this;var i=e.extend({},s(),t);var r=a.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var n=e.extend(true,{},l.lists[r],{options:null,template:null});if(!(l.autoSuggests[a]instanceof xe))i.data=n;l.autoSuggests[a]=new xe(i)};this.createEditor=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,i){var r=e(i).data("editor");if(!r||r.active||r.name.indexOf("$rowindex$")>-1||t&&r.name!=t)return true;r.create();if(t)return false})};this.updateTextArea=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,i){var r=e(i).data("editor");if(!r||t&&r.name!=t)return true;r.save();if(t)return false})};this.destroyEditor=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,i){var r=e(i).data("editor");if(!r||t&&r.name!=t)return true;r.destroy();if(t)return false})};this.onError=function(e,t){return j(this,e,t)};this.initUpload=function(){var a=this.getForm();e(a.elements).filter("input:file:not([name*='$rowindex$'],[id='importfiles'])").each(function(a){e.later(t.AJAX_DELAY*a,null,bt,this)})};this.setupFilters=function(a,i){var r=this.id,n=this.filterList?this.filterList.data:null,s=e(".ew-save-filter[data-form="+r+"]").toggleClass("disabled",!n),o=e(".ew-delete-filter[data-form="+r+"]").toggleClass("disabled",!i.length),d=o.parent("li").toggleClass("dropdown-submenu",!!i.length).toggleClass("disabled",!i.length),f=s.parent("li").toggleClass("disabled",!n),u=e(a.target);var c=function(a,i){if(t.SEARCH_FILTER_OPTION=="Client"){e.localStorage.set(a+"_filters",i)}else if(t.SEARCH_FILTER_OPTION=="Server"){var r={ajax:"savefilters",filters:JSON.stringify(i),token:t.ANTIFORGERY_TOKEN};e("body").css("cursor","wait");e.ajax(We(),{type:"POST",dataType:"json",data:r}).done(function(e){if(e[0]&&e[0].success)l.filterList.filters=i}).always(function(){e("body").css("cursor","default")})}};f.off("click.ew").on("click.ew",function(e){if(f.hasClass("disabled"))return false;E(t.language.phrase("EnterFilterName"),function(e){i[i.length]=[e,n];c(r,i)},true)}).prevAll().remove();o.next("ul.dropdown-menu").remove();if(i.length){var p=o.closest("ul.dropdown-menu");var h=e("<ul class='dropdown-menu'></ul>");for(var g in i){if(!e.isArray(i[g]))continue;e("<li><a class='dropdown-item' data-index='"+g+"' href='#'>"+i[g][0]+"</a></li>").on("click",function(a){var n=e(this).find("a[data-index]").data("index");E(t.language.phrase("DeleteFilterConfirm").replace("%s",i[n][0]),function(e){if(e){i.splice(n,1);c(r,i)}})}).appendTo(h);e("<li><a class='dropdown-item ew-filter-list' data-index='"+g+"' href='#'>"+i[g][0]+"</a></li>").insertBefore(f).on("click",function(a){var r=e(this).find("a[data-index]").data("index");e("<form>").attr({method:"post",action:We()}).append(e("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),e("<input type='hidden'>").attr({name:"token",value:t.ANTIFORGERY_TOKEN}),e("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(i[r][1])})).appendTo("body").submit()})}e("<li class='dropdown-divider'></li>").insertBefore(f);d.append(h)}};this.init=function(){if(this._initiated)return;if(t.SEARCH_FILTER_OPTION=="Client"&&window.localStorage||t.SEARCH_FILTER_OPTION=="Server"&&t.IS_LOGGEDIN&&!t.IS_SYS_ADMIN&&t.CURRENT_USER_NAME!=""){e(".ew-filter-option."+this.id+" .ew-btn-dropdown").on("show.bs.dropdown",function(a){var i=[];if(t.SEARCH_FILTER_OPTION=="Client")i=e.localStorage.get(l.id+"_filters")||[];else if(t.SEARCH_FILTER_OPTION=="Server")i=l.filterList&&l.filterList.filters?l.filterList.filters:[];var r=e.grep(i,function(t){if(e.isArray(t)&&t.length==2)return t});l.setupFilters(a,r)});e(".ew-filter-option").show()}else{e(".ew-filter-option").hide()}var i=this.getForm(),r=e(i);if(!i)return;this.compileTemplates();var n=r.hasClass("ew-search-form")||r.hasClass("ew-ext-search-form")||r.hasClass("ew-ext-filter-form");if(n&&this.initSearchPanel&&!A(i))e("#"+this.id+"-search-panel").removeClass("show");e(".ew-search-toggle[data-form="+this.id+"]").on("click.bs.button",function(){e("#"+e(this).data("form")+"-search-panel").collapse("toggle")});if(!e(".ew-table .ew-search-operator").text().trim())e(".ew-table .ew-search-operator").parent("td").hide();if(n){e(".ew-highlight[data-form="+this.id+"]").on("click.bs.button",function(){e("span."+e(this).data("name")).toggleClass("ew-highlight-search")})}if(n){r.find("select[id^=z_]").each(function(){var t=e(this).change();if(t.val()!="BETWEEN")r.find("#w_"+this.id.substr(2)).change()})}if(this.multiPage)this.multiPage.render();this.createEditor();this.updateLists();this.initUpload();if(!t.RESET_HEIGHT&&r.is("form")){if(r.width()>e(".content").width())a.trigger("overflow",[r])}if(this.$element.is("form")){r.submit(function(e){return l.submit()});r.find("[data-field], .ew-priv").change(function(){if(t.CONFIRM_CANCEL)l.modified=true});r.find("#btn-cancel[data-href]").click(function(){l.updateTextArea();l.postAutoSuggest();var a=e(this).data("href");if(l.modified&&A(i)){E(t.language.phrase("ConfirmCancel"),function(e){if(e)window.location=a})}else{window.location=a}})}this._initiated=true;this.$element.data("form",this)};n[this.id]=this}function _(t){var a=t&&t.target?t.target:document,i=e(a);for(var r in n){if(i.find("#"+r))n[r].init()}}function E(t,a,i){var r=e("#ew-prompt"),n=r.find(".modal-body").empty();if(i){n.append('<div class="form-group row">'+'<label class="col-form-label">'+t+"</label>"+'<input type="text" class="form-control d-block w-100"></div>');var s=n.find("input").click(function(){s.removeClass("is-invalid")});r.find(".modal-footer .btn-primary").off().click(function(t){var i=s.val().trim();if(i==""){s.addClass("is-invalid");s[0].focus()}else{r.modal("hide");if(e.isFunction(a))a(i)}});r.on("shown.bs.modal",function(e){s[0].focus()})}else{n.append("<div>"+t+"</div>");r.find(".modal-footer .btn-primary").off().click(function(t){r.modal("hide");if(e.isFunction(a))a(true)});if(a){r.find(".modal-footer .btn-default").off().click(function(t){r.modal("hide");if(e.isFunction(a))a(false)}).show()}else{r.find(".modal-footer .btn-default").hide()}}r.modal("show")}function b(t){var a=e(t),i=a.closest(".ew-form");if(!i[0])i=a.closest(".ew-grid, .ew-multi-column-grid").find(".ew-form").not(".ew-pager-form");return i[0]}function A(t){var a="[name^=x_][value!='{value}'],[name^=y_],[name^=z_],[name^=w_],[name=psearch]",i=e(t).find(a).filter(":enabled").get();for(var r=0,n=i.length;r<n;r++){var s=i[r];if(/^(z|w)_/.test(s.name)){if(/^IS/.test(e(s).val()))return true}else if(s.type=="checkbox"||s.type=="radio"){if(s.checked)return true}else if(s.type=="select-one"||s.type=="select-multiple"){if(!!e(s).val())return true}else if(s.type=="text"||s.type=="hidden"||s.type=="textarea"){if(s.value)return true}}return false}function w(a,i){var r=e(a),n=r.closest("form"),s="";n.find("input[name=psearchtype]").val(i||"");if(i=="="){s=t.language.phrase("QuickSearchExactShort")}else if(i=="AND"){s=t.language.phrase("QuickSearchAllShort")}else if(i=="OR"){s=t.language.phrase("QuickSearchAnyShort")}else{s=t.language.phrase("QuickSearchAutoShort")}n.find("#searchtype").html(s+(s?"&nbsp;":""));r.closest("ul").find("li").removeClass("active");r.closest("li").addClass("active");return false}function S(i,r,s,l){var o=this,d=e(this);var f=function(){if(d.queue().length){d.dequeue()}else{a.trigger("updatedone",[{source:o,target:i}])}};var u=this.$element?this.$element[0]:this.form?this.form:null;if(!u)return f();var c=this._form?this:n[u.id];if(!c)return f();var p=e.makeArray(arguments);if(this.form&&e.isUndefined(i))i=n(this).lists[this.name.replace(/^(sv_)?[xy]\d*_/,"x_")].childFields.slice();if(!i||e.isArray(i)&&i.length==0)return f();if(e.isArray(i)&&e.isString(i[0])){for(var h=0,g=i.length;h<g;h++){var v=i[h].split(" ");if(v.length==1&&o.form){var m=Ee(o,false).match(/^([xy]\d*_)/);if(m)i[h]=i[h].replace(/^([xy]\d*_)/,m[1])}var _=de(i[h],u),E=[];if(v.length==2&&e.isArray(_)){var A=e(_);A.each(function(){if(!E.includes(this.name)){E[E.length]=this.name;var t=A.filter("[name='"+this.name+"']"),a=t.attr("type");if(a=="radio"||a=="checkbox")d.queue(e.proxy(S,o,t.get(),r,s,l));else d.queue(e.proxy(S,o,t[0],r,s,l))}})}else{d.queue(e.proxy(S,o,_,r,s,l))}}var w=n(this).lists[this.name.replace(/^[xy]\d*_/,"x_")];if(w&&w.autoFill)d.queue(function(){He(o)});return f()}if(e.isString(i))i=de(i,u);if(!i||e.isArray(i)&&i.length==0)return f();var v=ve(i);var I=Ee(i,false);if(!I)return f();var O="",y="",m=I.match(/^([xy])(\d*)_/);if(m){O=m[1];y=m[2]}var x=I.replace(/^([xy])(\d*)_/,"x_");var L=[];var C=b(i);if(!C||!C.id)return f();var R=n[C.id];if(!R)return f();if(e.isUndefined(r)){r=R.lists[x].parentFields.slice();if(y!=""){for(var h=0,g=r.length;h<g;h++){var N=r[h].split(" ");if(N.length==1)r[h]=r[h].replace(/^x_/,"x"+y+"_")}}else if(O=="y"){}}if(e.isArray(r)&&r.length>0){if(e.isArray(r[0])){L=r}else if(e.isString(r[0])){for(var h=0,g=r.length;h<g;h++)L[L.length]=ve(r[h],u)}}if(!F(i))_e(i);var P=function(t){for(var r=0,n=t.length;r<n;r++){var s={data:t[r],parents:L,valid:true,name:Ee(i),form:C};a.trigger("addoption",[s]);if(s.valid)Te(i,t[r],C)}if(!i.options&&i.length){Ie(i);i=de(I,C)}Oe(i,v);if(l!==false){if(!i.options&&i.length)e(i).first().triggerHandler("click");else e(i).first().change()}};if(e.isUndefined(s))s=R.lists[x].ajax;if(!e.isBoolean(s)||e.isArray(R.lists[x].options)&&R.lists[x].options.length>0){var M=R.lists[x].options;P(M);if(/s(ea)?rch$/.test(u.id)&&O=="x"){p[0]=I.replace(/^x_/,"y_");S.apply(this,p)}return f()}else{var D=Ee(i),k=e.extend(true,{},R.lists[x],{options:null,template:null,ajax:"updateoption",name:D,token:t.ANTIFORGERY_TOKEN},T("#p_"+I,u));k[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;if(F(i)&&this._form)k["v0"]=v[0]?v[0]:Et();else if($(i))k["v0"]=v[0]?e(i).data("multiple")?v.join(t.LOOKUP_FILTER_VALUE_SEPARATOR):v[0]:Et();for(var h=0,U=L.length;h<U;h++)k["v"+(h+1)]=L[h].join(t.LOOKUP_FILTER_VALUE_SEPARATOR);ye(i,"wait");e.ajax(t.API_URL,{type:"POST",dataType:"json",data:k,async:s,success:function(e){P(e.records||[])}}).always(function(){ye(i,"auto");f()});if(/s(ea)?rch$/.test(u.id)&&O=="x"){p[0]=I.replace(/^x_/,"y_");S.apply(this,p)}}}function T(t,a){var t=t.replace(/\[\]$/,""),i={};var a=!e.isString(a)?a:/^#/.test(a)?a:"#"+a;var r=a?e(a).find(t):e(t);var n=r.val();if(n){var s=n.split("&");for(var l=0,o=s.length;l<o;l++){var d=s[l].split("=");if(d.length==2)i[d[0]]=d[1]}}return i}function I(e){this.obj=e;this.phrase=function(e){return this.obj[e.toLowerCase()]}}function O(i,r,n,s,l){var o,d={data:l||{},id:i,template:r,filename:n,export:s,enabled:true};if(e.views&&r&&(o=e("#"+r))[0]){if(!o.attr("type"))o.attr("type","text/html");a.trigger("rendertemplate",[d]);if(d.enabled)e("#"+i).html(o.render(d.data))}if(s&&s!="print"){e(function(){var a=e("meta[http-equiv='Content-Type']");var r="<html><head>";var n=e("#"+i);if(a[0])r+="<meta http-equiv='Content-Type' content='"+a.attr("content")+"'>";if(s=="pdf"){r+="<link rel='stylesheet' type='text/css' href='"+t.PDF_STYLESHEET_FILENAME+"'>";if(n.children(0).is("div[id^=ct_]"))n=n.children(0)}else{r+="<style>"+e.ajax({async:false,type:"GET",url:t.PROJECT_STYLESHEET_FILENAME}).responseText+"</style>"}r+="</"+"head><body>"+n.html()+"</body></html>";var l=We();var o={customexport:s,data:r,filename:d.filename};if(s=="email"){var f=window.location.search.replace(/^\?/,"")+"&"+e.param(o)+"&token="+t.ANTIFORGERY_TOKEN;e.post(l,f,function(e){_t(e)})}else{p(l,o)}})}}function y(t,i){var r=t&&t.render?t:e(t);if(!r.render)return;var n={$template:r,data:i};a.trigger("rendertemplate",[n]);var s=r.render(n.data),l=n.$template.data("method"),o=n.$template.data("target");if(s&&l&&o)e(s)[l](o);else if(s&&!l&&o)e(o).html(s);else if(s&&!l&&!o)r.parent().append(s);return s}function x(a){var i={},r=a&&a.target?a.target:document;e(r).find(".ew-js-template").sort(function(t,a){t=parseInt(e(t).data("seq"),10)||0;a=parseInt(e(a).data("seq"),10)||0;if(t>a){return 1}else if(t<a){return-1}else{return 0}}).each(function(a){var i=e(this),r=i.data("name"),n=i.data("data");if(n&&e.isString(n)){n=t.vars[n]||window[n];if(!n)return}if(r){if(!e.render[r]){e.templates(r,i.text());y(i,n)}}else{y(i,n)}})}function L(t){e("script"+(t?"."+t:"")+"[type='text/html']").each(function(){var t=e(this);if(/^\s*(<(td|th)[\s\S]*>[\s\S]*<\/\2>)\s*$/i.test(t.html())){t.next().before(RegExp.$1)}else{e(this).after(e("<span></span>").addClass(t.attr("class")).html(t.html()))}t.closest(".ew-table, .ew-view-table, .ew-grid").removeClass("d-none").show()})}function C(e){return e&&["1","y","t","true"].includes(e.toLowerCase())}function R(t,a,i,r){var n=de("x"+a+"_"+i,t);var s=fe("o"+a+"_"+i,t);var l=fe("fn_x"+a+"_"+i,t);if(!s&&(!n||e.isArray(n)&&n.length==0))return false;var o=function(e){return ve(e).join(",")};if(s&&n){if(r){if(C(o(s))===C(o(n)))return false}else{var d=o(s);var f=l?o(l):o(n);if(d==f)return false}}return true}function N(e,t){t=t||window.location.search;var a=/(?:\?|&)([^&=]+)=?([^&]*)/g;var i=/\+/g;var r=function(e){return decodeURIComponent(e.replace(i," "))};var n={},s;while((s=a.exec(t))!==null){var l=r(s[1]).replace(/\[\]$/,""),o=r(s[2]);(n[l]||(n[l]=[])).push(o)}return e?n[e]:n}function P(t){var a=e(t),i=a.val()||a.data("language");if(!i)return;var r=window.location.href;if(window.location.search){var n=window.location.search;var s={};n.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,a){if(t)s[t]=a});s["language"]=encodeURIComponent(i);var l="?";for(var o in s)l+=o+"="+s[o]+"&";l=l.substr(0,l.length-1);var d=r.lastIndexOf(window.location.search);r=r.substr(0,d)+l}else{if(window.location.hash)r=r.split("#")[0]+"?language="+encodeURIComponent(i)+"#"+r.split("#")[1];else r+="?language="+encodeURIComponent(i)}window.location=r}function M(a,i){var r=a.target||a.srcElement,n=e(r),s=i.f||n.closest("form")[0]||currentForm,l=e(s),o=i.key,d=i.action,f=i.url||We(),u=i.msg,c=i.data,p=i.success,h=!i.method||pe(i.method[0],"p"),g=!i.select&&!i.key||i.select&&pe(i.select[0],"m");if(g&&!l[0])return;if(g&&!V(l[0])){E('<p class="text-danger">'+t.language.phrase("NoRecordSelected")+"</p>");return}var v=function(e){_t(e)};var m=function(){if(h){if(d)e("<input>").attr({type:"hidden",name:"useraction",value:d}).appendTo(l);if(e.isObject(c)){for(var a in c){var i=l.find("input[type=hidden][name='"+a+"']");if(i[0])i.val(c[a]);else e("<input>").attr({type:"hidden",name:a,value:c[a]}).appendTo(l)}}if(!g&&e.isObject(o)){for(var a in o)e("<input>").attr({type:"hidden",name:a,value:o[a]}).appendTo(l)}l.prop("action",f).submit();if(d)l.find("input[type=hidden][name=useraction]").remove()}else{c=e.isObject(c)?e.param(c):e.isString(c)?c:"";c+=(c?"&":"")+"token="+t.ANTIFORGERY_TOKEN;if(d)c+="&useraction="+d+"&ajax="+d;if(g)c+="&"+l.find("input[name='key_m[]']:checked").serialize();else if(o)c+="&"+(e.isObject(o)?e.param(o):o);if(p&&e.isString(p))p=window[p];if(!e.isFunction(p))p=v;e.post(f,c,p)}};if(u){E(u,function(e){if(e)m()})}else{m()}}function D(a,i,r,n,s,l){if(!a)return;var o=e(a),d=o.attr("target"),f=o.attr("action");var u=s&&o.find("input[type=checkbox][name='key_m[]']")[0];if(u&&!V(a)){H(t.language.phrase("NoRecordSelected"));return}if(n){e("iframe.ew-export").remove();if(r=="email")i+=("&"+e(l).serialize()).replace(/&export=email/i,"");if(u){e("<iframe>").attr("name","ew-export-frame").addClass("ew-export d-none").appendTo(e("body"));try{o.append(e("<input type='hidden'>").attr({name:"custom",value:"1"})).attr({action:i,target:"ew-export-frame"}).find("input[name=exporttype]").val(r).end().submit()}finally{o.attr({target:d||"",action:f}).find("input[name=custom]").remove()}}else{e("<iframe>").attr({name:"ew-export-frame",src:i}).addClass("ew-export d-none").appendTo(e("body"))}}else{o.find("input[name=exporttype]").val(r);if(r=="print")o.submit();else p(f,o.serialize())}}function k(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e}function U(t){var a=e(t);return t&&a.is(":hidden")&&a.data("editor")}function $(t){var a=e(t);return t&&a.is(":hidden")&&a.data("lookup")}function F(t){var a=e(t);return a[0]&&a.is(":hidden")&&a.data("autosuggest")}function B(e){return n(e).autoSuggests[e.id]}function H(a,i,r){if(t.IS_MOBILE){alert(a);if(i)e.later(100,null,i)}else{var n=e("#ew-message-box");n.find(".modal-body").html('<p class="text-'+(r||"danger")+'">'+a+"</p>");n.modal("show");if(i)n.off("hidden.bs.modal").on("hidden.bs.modal",i)}}function j(e,t,a){if(t.jquery){var i=t.attr("type");t=i=="checkbox"||i=="radio"?t.get():t[0]}H(a,function(){G(t)});if(e){if(e.multiPage){e.multiPage.gotoPageByElement(t)}else if(e.$element.is("div")){var r=e.$element.closest(".tab-pane");if(r[0]&&!r.hasClass("active"))r.closest(".tabbable, .ew-nav-tabs").find("a[data-toggle=tab][href='#"+r.attr("id")+"']").click()}}return false}function G(t){if(!t)return;var a=e(t);if(U(t)){return a.data("editor").focus()}else if(!t.options&&t.length){t=a.filter("[value!='{value}']")[0]}else if(F(t)){t=B(t).input}var i=a.closest(".form-group, [id^='el_']");if($(t)){i.find(":button").on("click",function(){i.find(".is-invalid").removeClass("is-invalid")})}else{if(t.type=="checkbox"||t.type=="radio"){a.filter("[value!='{value}']").addClass("is-invalid").focus().one("click keypress keyup",function(){i.find(".is-invalid").removeClass("is-invalid")})}else{e(t).addClass("is-invalid").focus().select().parent().one("click keypress keyup",function(){i.find(".is-invalid").removeClass("is-invalid")})}}}function Y(e){return ve(e).join("")!=""}function W(e,t,a){if(a==2&&e.ctrlKey)t+="&ctrl=1";location=t;return true}function z(e){ee(e);E(t.language.phrase("DeleteConfirmMsg"),function(t){t&&e.href?window.location=e.href:Z(e)});return false}function V(t){return e(t).find("input[type=checkbox][name='key_m[]']:checked",t).length>0}function K(a){X(a);var i=e(a).closest("."+t.TABLE_CLASSNAME)[0];if(!i)return;e(i.tBodies).each(function(){e(this.rows).each(function(i,r){var n=e(r);if(n.is(":not(."+t.ITEM_TEMPLATE_CLASSNAME+"):not(."+t.TABLE_PREVIEW_ROW_CLASSNAME+")")){n.data({selected:a.checked,checked:a.checked});J(i,r)}})})}function X(t){if(!t||!t.form)return;e(t.form.elements).filter("input[type=checkbox][name^="+t.name+"_], [type=checkbox][name="+t.name+"]").not(t).not(":disabled").prop("checked",t.checked)}function q(t){return e(t).find("input[type=checkbox][name^=u_]:checked,input:hidden[name^=u_][value=1]").length>0}function J(a,i){var r=e(i),n=r.closest("."+t.TABLE_CLASSNAME);if(!n[0])return;if(r.data("selected")){r.removeClass(n.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME).removeClass(n.data("roweditclass")||t.TABLE_EDIT_ROW_CLASSNAME).addClass(n.data("rowselectclass")||t.TABLE_SELECT_ROW_CLASSNAME)}else if([t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(r.data("rowtype"))){r.removeClass(n.data("rowselectclass")||t.TABLE_SELECT_ROW_CLASSNAME).removeClass(n.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME).addClass(n.data("roweditclass")||t.TABLE_EDIT_ROW_CLASSNAME)}else{r.removeClass(n.data("rowselectclass")||t.TABLE_SELECT_ROW_CLASSNAME).removeClass(n.data("roweditclass")||t.TABLE_EDIT_ROW_CLASSNAME).removeClass(n.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME)}}function Q(t){e(t.rows).each(function(t,a){var i=e(a);if(!i.data("checked")&&i.data("selected")){i.data("selected",false);J(t,a)}})}function Z(a){var i=e(a),r=i.closest("."+t.TABLE_CLASSNAME)[0];if(!r)return;var n=i.closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each(function(t,a){var i=e(a);i.data("selected",i.data("checked"))})}function ee(a){var i=e(a),r=i.closest("."+t.TABLE_CLASSNAME)[0];if(!r)return;Q(r);var n=i.closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("selected",true);J(t,a)})}function te(a){var i=a.target||a.srcElement,r=e(i),n=r.closest("."+t.TABLE_CLASSNAME)[0];if(!n)return;Q(n);var s=r.closest(".ew-table > tbody > tr");s.siblings("[data-rowindex='"+s.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("checked",i.checked).data("selected",i.checked).find("input[type=checkbox][name='key_m[]']").each(function(){if(this!=i)this.checked=i.checked});J(t,a)});a.stopPropagation()}function ae(a,i,r){var n=e(i),s=e(i.rows);if(!i||!i.rows||!r&&n.data("isset")||i.tBodies.length==0)return;var l=function(a){var i=e(this);if(!i.data("selected")&&![t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(i.data("rowtype"))){var r=i.closest("."+t.TABLE_CLASSNAME);if(!r[0])return;i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each(function(a,i){e(i).addClass(r.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME)})}};var o=function(a){var i=e(this);if(!i.data("selected")&&![t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(i.data("rowtype")))i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each(J)};var d=function(a){var i=e(this),r=i.closest("."+t.TABLE_CLASSNAME)[0],n=e(a.target);if(!r||n.hasClass("btn")||n.hasClass("ew-preview-row-btn")||n.is(":input"))return;if(!i.data("checked")){var s=i.data("selected");Q(r);i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("selected",!s);J(t,a)})}};var f=s.filter("[data-rowindex=1]").length||s.filter("[data-rowindex=0]").length||1;var u=s.filter(":not(."+t.ITEM_TEMPLATE_CLASSNAME+")").each(function(){e(this.cells).removeClass(t.TABLE_LAST_ROW_CLASSNAME).last().addClass(t.TABLE_LAST_COL_CLASSNAME)}).get();var c=n.parentsUntil(".ew-grid",".table-responsive")[0];if(u.length){for(var p=1;p<=f;p++){var h=u[u.length-p];e(h.cells).each(function(){if(this.rowSpan==p)e(this).addClass(t.TABLE_LAST_ROW_CLASSNAME).toggleClass(t.TABLE_BORDER_BOTTOM_CLASSNAME,!!c&&c.clientHeight>i.offsetHeight)})}}var g=n.closest("form")[0];var v=g&&e(g.elements).filter("input#action:not([value^=grid])").length>0;e(i.tBodies[i.tBodies.length-1].rows).filter(":not(."+t.ITEM_TEMPLATE_CLASSNAME+"):not(."+t.TABLE_PREVIEW_ROW_CLASSNAME+")").each(function(a){var i=e(this);if(v&&!i.data("isset")){if([t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(i.data("rowtype")))i.on("mouseover",function(){this.edit=true}).addClass(t.TABLE_EDIT_ROW_CLASSNAME);i.on("mouseover",l).on("mouseout",o).on("click",d);i.data("isset",true)}var r=a%(2*f)<f;i.toggleClass(t.TABLE_ROW_CLASSNAME,r).toggleClass(t.TABLE_ALT_ROW_CLASSNAME,!r)});ie(a,n.closest("."+t.GRID_CLASSNAME)[0],r);n.data("isset",true)}function ie(a,i,r){var n=e(i);if(!i||!r&&n.data("isset"))return;var s=n.find("table.ew-multi-column-table").length,l;if(s){l=n.find("td[data-rowindex]").length}else{l=n.find("table."+t.TABLE_CLASSNAME+" > tbody:first > tr:not(."+t.TABLE_PREVIEW_ROW_CLASSNAME+", ."+t.ITEM_TEMPLATE_CLASSNAME+")").length}if(l==0&&!n.find(".ew-grid-upper-panel, .ew-grid-lower-panel")[0])n.hide();n.find(".ew-grid-upper-panel, .ew-grid-lower-panel").each(function(){var t=e(this),a=t.children().map(function(){return e(this).html()}).get().join("");if(a.trim()=="")t.remove()});if(!n.find(".ew-grid-upper-panel:visible")[0])n.css({"border-top-left-radius":0,"border-top-right-radius":0});if(!n.find(".ew-grid-lower-panel:visible")[0])n.css({"border-bottom-left-radius":0,"border-bottom-right-radius":0});n.data("isset",true)}function re(a){var i=e(a).closest("."+t.GRID_CLASSNAME),r=i.find("table."+t.TABLE_CLASSNAME).last(),n=r.parent("div"),s=r.find("tr."+t.ITEM_TEMPLATE_CLASSNAME);if(!a||!i[0]||!r[0]||!s[0])return;var l=e(r[0].rows).last();r.find("td."+t.TABLE_LAST_ROW_CLASSNAME).removeClass(t.TABLE_LAST_ROW_CLASSNAME);var o=s.clone(true,true).removeClass(t.ITEM_TEMPLATE_CLASSNAME);var d=i.find("div.ew-form[id^=f][id$=grid]");if(!d[0])d=i.find("form.ew-form[id^=f][id$=list]");var f=d.is("div")?"_"+d.attr("id"):"";var u=d.find("#key_count"+f);var c=parseInt(u.val(),10)+1;o.attr({id:"r"+c+o.attr("id").substring(2),"data-rowindex":c});var p=s.find("script:contains('$rowindex$')");o.children("td").each(function(){e(this).find("*").each(function(){e.each(this.attributes,function(e,t){t.value=t.value.replace(/\$rowindex\$/g,c)})})});o.find(".ew-icon").closest("a, button").removeData("bs.tooltip").tooltip({container:"body",placement:"bottom",trigger:"hover"});u.val(c).after(e("<input>").attr({type:"hidden",id:"k"+c+"_action"+f,name:"k"+c+"_action"+f,value:"insert"}));o.find("span[id^=as_]").each(function(){var t=parseInt(e(this).css("z-index"),10);if(t>0)e(this).css("z-index",t-c)});l.after(o);p.each(function(){Re(this.text.replace(/\$rowindex\$/g,c))});var h=d.data("form");if(h){h.createEditor();h.initUpload()}ae(-1,r[0],true);n.scrollTop(n[0].scrollHeight)}function ne(a,i){var r=e(a).tooltip("hide").removeData("bs.tooltip"),n=r.closest("."+t.GRID_CLASSNAME+", ."+t.MULTI_COLUMN_GRID_CLASSNAME),s=r.closest("tr, div[data-rowindex]"),l=s.closest("."+t.TABLE_CLASSNAME);if(!a||!n[0]||!s[0])return;var o=parseInt(s.data("rowindex"),10);var d=n.find("div.ew-form[id^=f][id$=grid]");if(!d[0])d=n.find("form.ew-form[id^=f][id$=list]");var f=d.data("form");if(!d[0]||!f)return;var u=d.is("div")?"_"+d.attr("id"):"";var c="#key_count"+u;var p=d.find(c);var h=function(){s.remove();if(n.is("."+t.GRID_CLASSNAME))ae(-1,l[0],true);if(o>0){var a=d.find("#k"+o+"_action"+u);if(a[0]){a.val(a.val()=="insert"?"insertdelete":"delete")}else{d.find(c).after(e("<input>").attr({type:"hidden",id:"k"+o+"_action"+u,name:"k"+o+"_action"+u,value:"delete"}))}}};if(e.isFunction(f.emptyRow)&&f.emptyRow(i)){h()}else{E(t.language.phrase("DeleteConfirmMsg"),function(e){if(e)h()})}return false}function se(e){var t=String(e);t=t.replace(/&/g,"&amp");t=t.replace(/\"/g,"&quot;");t=t.replace(/</g,"&lt;");t=t.replace(/>/g,"&gt;");return t}function le(t){e(t).find("[id^=x_],[id^=y_],[id^=n_]").each(function(){if(this.type=="checkbox"||this.type=="radio"){this.checked=false}else if(this.type=="select-one"){this.selectedIndex=0}else if(this.type=="select-multiple"){e(this).find("option").prop("selected",false)}else if(this.type=="text"||this.type=="textarea"||this.type=="hidden"&&F(this)){this.value="";if(this.type=="hidden")B(this).input.value=""}})}function oe(a){var i=this;this.$form=null;this.formID=a;this.pageIndex=1;this.maxPageIndex=0;this.minPageIndex=0;this.pageIndexes=[];this.$pages=null;this.$collapses=null;this.isTab=false;this.isCollapse=false;this.lastPageSubmit=false;this.hideDisabledButton=false;this.hideInactivePages=false;this.lockTabs=false;this.hideTabs=false;this.showPagerTop=false;this.showPagerBottom=false;this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><span class="icon-prev"></span> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <span class="icon-next"></span></a></li></ul></nav>';var r=function(e){e.preventDefault()};var n=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(arguments.length==1&&e.isObject(arguments[0])){var t=arguments[0];for(var a in t){var i=a[0].toLowerCase()+a.substr(1);if(n.includes(i))this[i]=t[a]}}};this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,t.language.phrase("Prev")).replace(/\{next\}/i,t.language.phrase("Next"));if(this.isTab){if(this.showPagerTop)this.$pages.closest(".tabbable, .ew-nav-tabs").before(e);if(this.showPagerBottom)this.$pages.closest(".tabbable, .ew-nav-tabs").after(e);this.$form.find(".ew-prev").click(function(e){i.$pages.off("show.bs.tab",r).filter(".active").parent().prev(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",false).click();return false});this.$form.find(".ew-next").click(function(e){i.$pages.off("show.bs.tab",r).filter(".active").parent().next(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",false).click();return false});if(this.hideTabs)this.$form.find(".ew-multi-page > .tabbable > .nav-tabs, .ew-multi-page > .ew-nav-tabs > .nav-tabs").hide()}else if(this.isCollapse){if(this.showPagerTop)this.$collapses.closest(".ew-accordion").before(e);if(this.showPagerBottom)this.$collapses.closest(".ew-accordion").after(e);this.$form.find(".ew-prev").click(function(e){i.$pages.closest(".card").filter(":has(.collapse.show)").prev(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",false).find("[data-toggle=collapse]").click();return false});this.$form.find(".ew-next").click(function(e){i.$pages.closest(".card").filter(":has(.collapse.show)").next(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",false).find("[data-toggle=collapse]").click();return false})}this.pageShow()};this.pageShow=function(){if(this.isTab){if(this.lockTabs)this.$pages.on("show.bs.tab",r);this.$pages.each(function(){var t=e(this);if(i.hideInactivePages)t.toggleClass("d-none",!t.hasClass("active"));if(i.lockTabs)t.toggleClass("disabled",!t.hasClass("active"))})}else if(this.isCollapse){this.$pages.closest(".card").each(function(){var t=e(this);if(i.hideInactivePages)t.toggleClass("d-none",!t.find(".collapse.show")[0])})}var t=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex;var a=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",t).toggle(!this.hideDisabledButton||!t);e(".ew-captcha").toggle(a.is(":visible:not(:disabled)"));t=this.pageIndex<=this.minPageIndex;this.$form.find(".ew-prev").toggleClass("disabled",t);t=this.pageIndex>=this.maxPageIndex;this.$form.find(".ew-next").toggleClass("disabled",t)};this.gotoPage=this.gotoPageByIndex=function(e){if(e<=0||e<this.minPageIndex||e>this.maxPageIndex)return;if(this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab){if(t.is(":not(.d-none):not(.disabled)"))t.click();else t.parent().next(":has([data-toggle=tab]):not(.d-none):not(.disabled)").find("[data-toggle=tab]").toggleClass("disabled",false).click()}else if(this.isCollapse){var a=t.closest(".card");if(a.is(":not(.d-none)"))t.click();else a.next(":has([data-toggle=collapse]):not(.d-none)").find("[data-toggle=collapse]").click()}this.pageIndex=e}};this.gotoPageByElement=function(t){this.gotoPage(parseInt(e(t).data("page"),10)||-1)};this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)};this.togglePage=function(e,t){if(this.isTab){this.$pages.eq(e-1).toggleClass("d-none",!t)}else if(this.isCollapse){this.$pages.eq(e-1).closest(".card").toggle("d-none",!t)}};this.render=function(){this.$form=e("#"+a);this.pageIndexes=this.$form.find("[data-page]").map(function(){var t=parseInt(e(this).data("page"),10);return t>0?t:null}).get();this.pageIndexes.sort(function(e,t){return e-t});this.minPageIndex=this.pageIndexes[0];this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var r=this.$form.find("[data-toggle=tab]");if(r[0]){this.$pages=r;this.isTab=true;r.on("shown.bs.tab",function(a){i.pageIndex=r.index(a.target)+1;i.pageShow();e(e(this).attr("href")).find(".ew-google-map").each(function(){var e=t.googleMaps[this.id];if(e&&e["map"]){google.maps.event.trigger(e["map"],"resize");e["map"].setCenter(e["latlng"])}})});this.pageIndex=r.index(r.parent(".active"))+1}else{this.$collapses=this.$form.find("[data-toggle=collapse]");if(this.$collapses[0]){this.$pages=this.$collapses;this.isCollapse=true;var n=this.$collapses.closest(".card-header").next();n.on("shown.bs.collapse",function(a){i.pageIndex=n.index(a.target)+1;i.pageShow();e(this).find(".ew-google-map").each(function(){var e=t.googleMaps[this.id];if(e&&e["map"]){google.maps.event.trigger(e["map"],"resize");e["map"].setCenter(e["latlng"])}})});this.pageIndex=n.index(n.hasClass("show"))+1}}e(function(){i.init()})}}function de(t,a){var i="[name='"+t+"']";var r=t.split(" ");if(r.length==2)i="[data-table='"+r[0]+"'][data-field='"+Ee(r[1])+"']:not([name^=o]):not([name^='x$'])";var a=!e.isString(a)?a:/^#/.test(a)?a:"#"+a;i="input"+i+",select"+i+",textarea"+i+",button"+i;var n=a?e(a).find(i):e(i);if(n.length==1&&n.is(":not([type=checkbox]):not([type=radio])"))return n[0];return n.get()}function fe(t,a){var a=e.isString(a)?"#"+a:a,i="#"+t.replace(/([\$\[\]])/g,"\\$1")+",[name='"+t+"']";return a?e(a).find(i)[0]:e(i).first()[0]}function ue(e,t){while(e=e.parentNode){if(e&&e.nodeType==1&&(!t||t(e)))return e}return null}function ce(t){return e(t).css("display")=="none"&&!e(t).closest(".dropdown-menu")[0]&&!$(t)&&!F(t)&&!U(t)||ue(t,function(t){var a=e(t);return a.css("display")=="none"&&!a.hasClass("tab-pane")&&!a.hasClass("collapse")})!=null}function pe(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function he(e,t){return String(e)==String(t)}function ge(e,t){return t.indexOf(e)}function ve(a,i){var r;if(e.isString(a)){var n=a.split(" ");if(n.length==2){r=de(a)}else{r=de(a,i)}}else{r=a}if(r.options){return e(r).find("option:selected[value!='']").map(function(){return this.value}).get()}else if(e.isNumber(r.length)){return e(r).filter(":checked[value!='{value}']").map(function(){return this.value}).get()}else{var s=e(r).data();if(s.lookup&&s.multiple)return r.value.split(t.LOOKUP_FILTER_VALUE_SEPARATOR);else return[r.value]}}function me(t,a){var i;if(e.isString(t)){var r=t.split(" ");if(r.length==2){i=de(t)}else{i=de(t,a)}}else{i=t}if(i.options){return e(i).find("option:selected[value!='']").map(function(){return this.text}).get()}else if(e.isNumber(i.length)){return e(i).filter(":checked[value!='{value}']").map(function(){return e(this).parent().text()}).get()}else if(F(i)){return[B(i).input.value]}else if($(i)){var n=e(i);return n.parent().find(".ew-lookup-text .ew-option").map(function(){return e(this).text().trim()}).get()}else{return[i.value]}}function _e(t){if(t.options){var a=t.type=="select-multiple"||e(t).data("pleaseselect")===false||t.length>0&&t.options[0].value!=""?0:1;for(var i=t.length-1;i>=a;i--)t.options[i]=null}else if(t.length){var r=Ee(t),n=e(t).parent().parent().find("#dsl_"+r);n.data("options",[]).find("div").first().empty()}else if(F(t)){var s=B(t);s._options=[];s.input.value="";t.value=""}else if($(t)){e(t).data("options",[])}}function Ee(t,a){var i=e.isString(t)?t:e(t).attr("name")||e(t).attr("id");return a!==false?i.replace(/\[\]$/,""):i}function be(t,a){var i=e(a).data("value-separator");return e.isArray(i)?i[t-1]:i||", "}function Ae(t,a){var i=t.df;for(var r=2;r<=4;r++){if(t["df"+r]&&t["df"+r]!=""){var n=be(r-1,a);if(e.isUndefined(n))break;if(i!="")i+=n;i+=t["df"+r]}}return i}function we(e){return t.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function Se(e,a){if(e.length>(a||t.MAX_OPTION_COUNT)){return t.language.phrase("CountSelected").replace("%s",e.length)}else if(e.length){var i="";for(var r=0;r<e.length;r++)i+=we(e[r]);return i}else{return t.language.phrase("PleaseSelect")}}function Te(t,i,r){var s=n[r.id],l=Ee(t),o=Ee(t,false),d,f=i.lf,u={lf:i.lf,df1:i.df,df2:i.df2,df3:i.df3,df4:i.df4};if(s.lists(o).template&&!F(t)){d=s.lists(o).template.render(u)}else{d=Ae(i,t)||f}var c={data:u,name:l,form:r.$element,value:f,text:d};if(t.options){e.extend(c,{option:e("<option></option>").val(c.value).html(c.text)});a.trigger("newoption",[c]);e(t).append(c.option)}else if(t.length){var p=e(fe("dsl_"+l,r)),h=p.data("options");if(p[0]&&h)h[h.length]={val:c.value,lbl:c.text}}else if(F(t)){var g=B(t);g._options[g._options.length]={val:c.value,lbl:c.text}}else if($(t)){var v=e(t),h=v.data("options")||[];h[h.length]={val:c.value,lbl:c.text};v.data("options",h)}return c.text}function Ie(i){var r=Ee(i),n=b(i),s=e(i).parent().parent().find("#dsl_"+r);if(!s[0]||!s.data("options"))return;var l=s.parent().find("#tp_"+r);if(!l[0])return;var o=!t.IS_MOBILE?parseInt(s.data("repeatcolumn"),10)||5:1;var d=l.contents(),f=s.data("options"),u=d.attr("type");var c=s.prevAll(".dropdown-toggle"),p=s.closest(".ew-dropdown-list").find(".ew-dropdown-clear");if(f&&f.length){if(o>1||u=="checkbox"||!c[0]){var h=e('<div class="d-table ew-item-table"></div>');if(u=="checkbox")h.click(function(e){e.stopPropagation()});for(var g=0,v=f.length;g<v;g++){var m;if(g%o==0)m=e('<div class="d-table-row"></div>');var _=d.clone(true).val(f[g].val).click(function(t){if(c[0]){var a=h.find("input[name='"+this.name+"']:checked");var i=a.map(function(){return e(this).parent().text()});c.html(Se(i.get(),e(this).data("maxcount")));p.prop("disabled",i.length==0)}});_.attr("id",_.attr("id")+"_"+g+"_"+Et());var E=e('<label class="form-check-label"></label>').attr("for",_.attr("id")).append(f[g].lbl);var A={name:r,form:n,value:f[g].val,text:f[g].lbl,option:e('<div class="form-check"></div>').append(_.add(E))};a.trigger("newoption",[A]);e('<div class="d-table-cell"></div>').append(A.option).appendTo(m);if(g%o==o-1){h.append(m)}else if(g==v-1){for(var w=g%o+1;w<o;w++)m.append('<div class="d-table-cell"></div>');h.append(m)}}s.find("div").first().append(h)}else{var S=e('<div class="list-group"></div>');for(var g=0,v=f.length;g<v;g++){var _=d.clone(true).val(f[g].val).click(function(a){var i=e(this).closest(".list-group-item");if(i.hasClass("active"))this.checked=false;i.siblings(".list-group-item").removeClass("active");i.toggleClass("active",this.checked);c.html(this.checked?i.text():t.language.phrase("PleaseSelect"));p.prop("disabled",!this.checked)});_.attr("id",_.attr("id")+"_"+g+"_"+Et());var E=e('<label class="form-check-label"></label>').attr("for",_.attr("id")).append(f[g].lbl);var T=e('<a class="list-group-item list-group-item-action" href="#"></a>').append(_,E);var A={name:r,form:n,value:f[g].val,text:f[g].lbl,option:T};a.trigger("newoption",[A]);S.append(A.option)}s.find("div").first().append(S)}p.prop("disabled",c&&(c.html()||"").trim()==t.language.phrase("PleaseSelect")).off().click(function(e){s.find("[data-field][type=radio], [data-field][type=checkbox]").prop("checked",false).first().triggerHandler("click");s.find(".list-group-item.active").removeClass("active");c.html(t.language.phrase("PleaseSelect"))})}if(!s.hasClass("dropdown-menu"))s.removeClass("d-none");s.data("options",[])}function Oe(a,i){if(!a||!i)return;var r=e(a);if(e.isArray(i)){if(a.options){e(a).val(i);if(a.type=="select-one"&&a.selectedIndex==-1)a.selectedIndex=0}else if(a.length){if(a.length==1&&a[0].type=="checkbox"&&a[0].value!="{value}"){a[0].checked=C(a[0].value)===C(i[0])}else{r.val(i).closest(".ew-dropdown-list").find(".ew-dropdown-clear").prop("disabled",false)}}else if(F(a)&&i.length==1){var s=B(a),l=s._options||[];for(var o=0,d=l.length;o<d;o++){if(l[o].val==i[0]){a.value=l[o].val;s.input.value=l[o].lbl;break}}}else if($(a)){var r=e(a),f=[],u=[],l=r.data("options")||[];for(var c=0,p=i.length;c<p;c++){for(var o=0,d=l.length;o<d;o++){if(i[c]==l[o].val){f.push(l[o].val);u.push(we(l[o].lbl));break}}}r.val(f.join(t.LOOKUP_FILTER_VALUE_SEPARATOR));r.parent().find(".ew-lookup-text").html(Se(u,r.data("maxcount")))}else if(a.type){a.value=i.join(",")}}function h(t){if(!e(t).data("autoselect"))return false;var a=b(t);if(a){if(/s(ea)?rch$/.test(a.id))return false;var i=n[a.id].lists(t.id);if(i&&i.parentFields.length==0)return false;return true}return false}if(a.options){if(a.type=="select-one"&&a.options.length==2&&!a.options[1].selected&&h(a)){a.options[1].selected=true}else if(a.type=="select-multiple"&&a.options.length==1&&!a.options[0].selected&&h(a)){a.options[0].selected=true}}else if(a.length){if(a.length==2&&h(a[1]))a[1].checked=true;if(a[0].type=="radio")r.filter(":checked").closest(".list-group-item").addClass("active");var g=r.closest(".dropdown-menu");var v=g.closest(".ew-dropdown-list").find(".dropdown-toggle");if(v[0]){var m=g.find("input[name='"+a[0].name+"']:checked");var _=m.map(function(){return e(this).parent().text()});v.html(Se(_.get(),r.data("maxcount")))}}else if(F(a)){var s=B(a),l=s._options||[];if(l.length==1&&h(a)){a.value=l[0].val;s.input.value=l[0].lbl}}}function ye(t,i){if(t.options){e(t).css("cursor",i)}else if(t.length){var r=Ee(t),n=e(t).parent().parent().find("#dsl_"+r);n.find("div").first().css("cursor",i)}else if(F(t)){var s=B(t);e(s.input).css("cursor",i)}else if($(t)){e(t).parent().find(".ew-lookup-text").css("cursor",i)}else if(t.type){e(t).css("cursor",i)}else{a.css("cursor",i)}}function xe(a){var i,r,n=this,s=a.id,l=a.form,o=a.forceSelect;var d=s.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var f=RegExp.$1;var u={typeahead:{}};if(f=="$rowindex$")return u;var c=l.getElement();var p=l.getElement("sv_"+s);if(!p)return u;var h=l.getElement("sc_"+s);var g=l.lists[d].parentFields.slice();for(var v=0,m=g.length;v<m;v++){var _=g[v].split(" ");if(_.length==1)g[v]=g[v].replace(/^x_/,"x"+f+"_")}this.data=a.data;this.minWidth=a.minWidth;this.maxHeight=a.maxHeight;this.highlight=a.highlight;this.hint=a.hint;this.minLength=a.minLength;this.limit=a.limit;this.templates=e.extend({},a.templates);this.trigger=a.trigger;this.delay=a.delay;this.display=a.display||"value";this.input=p;this.element=l.getElement(s);this.$input=i=e(this.input);this.$element=r=e(this.element);this._options=[];this._recordCount=0;if(i.val()&&r.val())this._options.push({val:r.val(),lbl:i.val()});this.formatResult=function(e){return Ae(e,this.element)||e[0]};this.setValue=function(a){a=a||i.val();var n=i.data("results")?e.map(i.data("results"),function(e,t){if(e["value"]==a)return t}):[];if(n.length==0){if(this._options&&this._options.length&&this._options[this._options.length-1].lbl==a)return;if(o&&a){i.typeahead("val","").attr("placeholder",t.language.phrase("ValueNotExist")).addClass("is-invalid");r.val("").change();return}}else{if(!/s(ea)?rch$/.test(c.id)||o){var s=n[0];if(s>-1)a=i.data("results")[s]["lf"]}}if(a!==r.val())r.val(a).change()};this.generateRequest=function(){var a=e.extend(true,{},this.data,{name:this.element.name,ajax:"autosuggest",token:t.ANTIFORGERY_TOKEN},T("#p_"+s,c));if(g.length>0){for(var i=0,r=g.length;i<r;i++){var n=ve(g[i],c);a["v"+(i+1)]=encodeURIComponent(n.join(","))}}a[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;return a};this.prepare=function(a,i){var r={};r.data=this.generateRequest();r.type="POST";r.dataType="json";r.url=t.API_URL+"?q="+encodeURIComponent(a);r.url+="&n="+this.limit;if(e.isNumber(i))r.url+="&start="+i;r.url+="&rnd="+Et();return r};this.transform=function(t){var a;if(t&&t.result=="OK"){n._recordCount=t.totalRecordCount;a=t.records}i.data("results",a||[]);var r=e.map(i.data("results"),function(e){var t=e["value"]=n.formatResult(e);return{lf:e[0],df1:e[1],df2:e[2],df3:e[3],df4:e[4],value:t}});return r};this.source=function(t,a,i){n._recordCount=0;var r=n.prepare(t);e.ajax(r).done(function(e){i(n.transform(e))})};this.count=function(){return n.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length};this.more=function(){e("body").css("cursor","wait");var t=n.typeahead,a=t.menu.query,i=t.menu.datasets[0];var r=n.count();var s=n.prepare(a,r);e.ajax(s).done(function(e){e=n.transform(e);i._append(a,e);t.menu.$node.find(".tt-dataset").scrollTop(i.$lastSuggestion.outerHeight()*r)}).always(function(){e("body").css("cursor","default")})};i.on("typeahead:select",function(e,t){n.setValue(t.value)}).blur(function(e){var t=i.data("tt-typeahead");if(t&&t.isOpen()&&!t.menu.empty()){var a=t.menu.getActiveSelectable();if(a){var r=a.index();var s=i.data("results")[r][1];i.typeahead("val",s)}}n.setValue()}).focus(function(e){i.attr("placeholder",i.data("placeholder")).removeClass("is-invalid")});var E;if(l.lists[d].template){E=l.lists[d].template}else{E=n.templates["suggestion"]}if(E&&e.isString(E))E=e.templates(E);if(E)n.templates["suggestion"]=e.proxy(E.render,E);r.data("autosuggest",this);e(function(){var a={highlight:n.highlight,minLength:n.minLength,hint:n.hint,trigger:n.trigger,delay:n.delay};var o={name:l.id+"-"+s,source:n.source,templates:n.templates,display:n.display,limit:n.limit,async:true};var d=[a,o];r.trigger("typeahead",[d]);n.limit=o.limit;i.typeahead.apply(i,d);i.on("typeahead:rendered",function(){var i=n.typeahead.menu.$node;var r=i.find(".tt-more").html(t.language.phrase("More"));if(arguments.length>1&&n._recordCount>n.count()){var s;r.one(a.trigger,function(t){if(s)s.cancel();e.later(a.delay,null,function(){n.more()});t.preventDefault();t.stopPropagation()})}else{r.hide()}});i.off("blur.tt");n.typeahead=i.data("tt-typeahead");var f=n.typeahead.menu.$node.css("z-index",9001);if(n.minWidth)f.css("min-width",n.minWidth);var u=f.find(".tt-dataset");var c=n.maxHeight||(parseInt(u.css("line-height"),10)+6)*(o.limit+1);u.css({"max-height":c,"overflow-y":"auto"})})}function Le(e,t){var a,i=0,r=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;e=e.replace(/<head>[\s\S]*<\/head>/,"");while((a=r.exec(e))!=null){var n=RegExp.$2;if(/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1)&&n)Re(n,"scr_"+t+"_"+i++)}}function Ce(e){var t,a=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;var i=e;while((t=a.exec(e))!=null){var r=RegExp.lastMatch;if(/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1))i=i.replace(r,"")}return i}function Re(e,t){var a=document.createElement("SCRIPT");if(t)a.id=t;a.text=e;return document.body.appendChild(a)}function Ne(t){if(t)e("script[id^='scr_"+t+"_']").remove()}function Pe(t){var a=Ce(t).match(/<body[\s\S]*>[\s\S]*<\/body>/i);return e(a[0]).not("div[id^=ew].modal, #ew-tooltip, #cookie-consent")}function Me(t){var a=e(t),i=a.closest("[id^=el]").find("#dsl_"+Ee(t));if(!i[0])return[];var r=a.filter(":checked").map(function(){return this.value}).get();_e(t);i.data("options",a.filter("[value!='{value}']").map(function(){var t=e(this).parent().contents().not(this);return{val:this.value,lbl:t}}).get());return r}function De(t){if(t.options){return e(t.options).map(function(){return{value:this.value,name:this.text}}).get()}else if(t.length){return e(t).filter("[value!='{value}']").map(function(){var t=e(this).parent().contents().not(this);return{value:this.value,name:t.text()}}).get()}return[]}function ke(i){var r=function(){Ne(s.data("args").el);var e=s.removeData("args").find(".modal-body form").data("form");if(e)e.destroyEditor();s.find(".modal-body").html("");s.find(".modal-footer .btn-primary").unbind();s.data("showing",false)};var s=t.addOptionDialog||e("#ew-add-opt-dialog").on("hidden.bs.modal",r);if(s.data("showing"))return;s.data("showing",true);if(!s[0]){H("DIV #ew-add-opt-dialog not found.");return}var l=function(i){var r=i;var l=s.data("args");var o=n(l.lnk);var d=l.el;var f="x_",u=-1;if(d.match(/^(x(\d+)_)/)){f=RegExp.$1;u=parseInt(RegExp.$2,10)}var c=d.replace(new RegExp("^"+f),"x_");var p=o.lists[c];var h=p[t.API_LOOKUP_TABLE];if(e.isString(i)){try{r=e.parseJSON(i)}catch(e){}}if(r&&r.success&&r[h]){var g=r[h];s.modal("hide");var v=o.$element[0];var m=de(d,v);if(m){var c=d.replace(new RegExp("^"+f),"x_");var _=o.lists[c].linkField.slice();var E=o.lists[c].displayFields.slice();var b=o.lists[c].filterFields.slice();var A=o.lists[c].parentFields.slice();for(var w=0,S=A.length;w<S;w++){var T=A[w].split(" ");if(T.length==1)A[w]=A[w].replace(/^x_/,f)}var I=_!=""?g[_]:"";var O={lf:I};for(var w=0,S=E.length;w<S;w++){if(E[w]in g)O["df"+(w||"")]=g[E[w]]}for(var w=0,S=b.length;w<S;w++){if(b[w]in g)O["ff"+(w||"")]=g[b[w]]}if(I&&E.length>0&&O["df"]){var y=Ee(d,false),x=y.replace(new RegExp("^"+f),"x_");if(o.lists[x].ajax===null){var T=o.lists[x].options;T[T.length]=O}var L=[];for(var w=0,S=A.length;w<S;w++)L[L.length]=ve(A[w],v);var l={data:O,parents:L,valid:true,name:Ee(m),form:v};a.trigger("addoption",[l]);if(l.valid){var T=De(m),C=[];if(!m.options&&m.length)C=Me(m);var R=Te(m,O,v);if(m.options){m.options[m.options.length-1].selected=true;e(m).change().focus()}else if(m.length){Ie(m);m=de(y,v);if(C.length>0)Oe(m,C);if(m.length>0){var d=e(m).filter("[value!='{value}']").last()[0];if(d.type=="checkbox"||d.type=="radio")d.click();d.focus()}}else if(F(m)){var N=B(m);e(m).val(I).change();e(N.input).val(R).focus()}else if($(m)){var P=e(m),M=e(fe("lu_"+l.name,v));if(P.data("multiple")){var D=e(m).val(),C=[],k=String(I);if(D!=="")C=D.split(t.LOOKUP_FILTER_VALUE_SEPARATOR);if(!C.includes(k)){C.push(k);P.val(C.join()).change();var U=M.html(),H=M.find(".ew-option").map(function(){return e(this).html()}).get();if(H.length){H.push(R);M.html(Se(H,P.data("maxcount")))}else if(U==t.language.phrase("PleaseSelect")){M.html(we(R))}else if(U){M.html(t.language.phrase("CountSelected").replace("%s",C.length))}}}else{P.val(I).change();M.html(R)}}var j=e(v),G=j.is("div")?"_"+j.attr("id"):"";var Y=j.find("#key_count"+G).val();if(Y>0){for(var w=1;w<=Y;w++){if(w==u)continue;var W=de(c.replace(/^x/,"x"+w),v);var z=De(W),C=[];if(e.param(T)!=e.param(z))continue;if(!W.options&&W.length)C=Me(W);Te(W,O,v);if(!W.options&&W.length){Ie(W);if(C.length>0)Oe(W,C)}}}}}}}else{var V,K=s.find("div.ew-message-dialog").html(""),X=e("<div></div>").html(i).find("div.ew-message-dialog");if(X[0]){V=X.html()}else{V=r&&r.failureMessage?r.failureMessage:i;if(!V||String(V).trim()=="")V=t.language.phrase("InsertFailed");V='<p class="text-danger">'+V+"</p>"}K.html(V).show()}};var o=function(e){s.modal("hide");H("Server Error "+e.status+": "+e.statusText)};var d=function(a){var i=t.addOptionDialog;var r=i.find(".modal-body form")[0];var s=n[r.id];var d=a?a.target:null;if(d){s.enableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(d).prop("disabled",false).removeClass("disabled")};s.disableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(d).prop("disabled",true).addClass("disabled")}}if(s.canSubmit())e.post(t.API_URL,e(r).serialize(),l).fail(o).always(function(){s.enableForm()});return false};s.modal("hide");s.data("args",i);var f=function(r){var l=n(i.lnk);var o="x_";if(i.el.match(/^(x\d+_)/))o=RegExp.$1;var f=i.el.replace(o,"x_");var u=l.lists[f].parentFields.slice();var c=l.lists[f].filterFieldVars.slice();var p=l._form;var h=[],g=[];for(var v=0,m=u.length;v<m;v++){var _=u[v].split(" ");if(_.length==1)u[v]=u[v].replace(/^x_/,o)}for(var v=0,m=u.length;v<m;v++){h.push(ve(u[v],p));g.push(me(u[v],p))}s.find(".modal-title").html(e(i.lnk).closest(".ew-add-opt-btn").data("title"));s.find(".modal-body").html(Ce(r));var p=s.find(".modal-body form")[0];if(p){e(p).keypress(function(e){if(e.which==13)return d()});var E=function(t,a){return e.isArray(t)&&e.isArray(a)&&t[0]&&a[0]&&t.name==a.name&&t.form==a.form};for(var v=0,m=h.length;v<m;v++){var b=de(c[v],p);if(b&&(b.options||b.length)){var A=h[v];a.one("updatedone",function(e,t){var a=t.target;if(b==a||E(b,a))Oe(a,A)})}}}t.addOptionDialog=s.modal("show");s.find(".modal-footer .btn-primary").click(d).focus();Le(r,i.el);if(p){for(var v=0,m=h.length;v<m;v++){var b=de(c[v],p);if(b){if(F(b)){b.value=h[v][0];var w=B(b);w.input.value=g[v][0];w._options[w._options.length]={val:h[v][0],lbl:g[v][0]}}else if($(b)){b.value=h[v][0];S.call(n[p.id],b)}else if(b.options||b.length){}else{b.value=h[v][0]}}}}s.trigger("load.ew")};e.get(i.url,f).fail(o)}function Ue(t){var a=e(this),i=a.data("args");Ne("ModalDialog");var r=a.removeData("args").find(".modal-body form").data("form");if(r)r.destroyEditor();var n=a.find(".modal-body").html("");if(n.ewjtable&&n.ewjtable("instance"))n.ewjtable("destroy");a.find(".modal-footer .btn-primary").unbind();a.find(".modal-dialog").removeClass(function(e,t){var a=t.match(/table\-\w+/);return a?a[0]:""});a.data("showing",false);a.data("url",null);if(i&&i.reload)window.location.reload(true)}function $e(a){var i=a.f,r=e(i);e(a.lnk).tooltip("hide");if(i&&r){if(!r[0])return;if(!V(r[0])){E('<p class="text-danger">'+t.language.phrase("NoRecordSelected")+"</p>");return}}var s=t.modalDialog||e("#ew-modal-dialog").on("hidden.bs.modal",Ue);if(s.data("showing")&&s.data("url")==a.url)return;var l=function(){var t=s.data("args"),a=e(t.lnk);return t.caption||a.data("caption")||a.data("original-title")||""};var o=function(){var a=s.data("args");if(e.isNull(a.btn))return"";else if(a.btn&&a.btn!="")return t.language.phrase(a.btn);else return l()};var d=function(e){s.modal("hide");if(e.status)H("Server Error "+e.status+": "+e.statusText)};var f=function(t){e("body").css("cursor","default")};var u=function(t){if(e.isString(t)){try{t=e.parseJSON(t)}catch(e){}}return t};var c=function(t){var a=e("<a>",{href:t})[0];return window.location.pathname.endsWith(a.pathname)};var p=function(a){var i=u(a);if(e.isObject(i)){var r=i.url;if(i.modal&&!c(r)){var n=s.data("args");n.reload=true;if(i.caption)n.caption=i.caption;n.btn=i.view?null:"";r+=(r.split("?").length>1?"&":"?")+"modal=1&rnd="+Et();n.url=r;e("body").css("cursor","wait");e.ajax(r).done(g).fail(d).always(f)}else{s.modal("hide");window.location=r}}else{var l=Pe(a);var p=s.find(".modal-body").html(l);var v="";var m=p.find("#confirm");var _=p.find("#conflict");if(_&&_.val()=="1"){v+='<button type="button" id="btn-overwrite" class="btn btn-primary ew-btn">'+t.language.phrase("OverwriteBtn")+"</button>";v+='<button type="button" id="btn-reload" class="btn btn-default ew-btn">'+t.language.phrase("ReloadBtn")+"</button>";v+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>";s.find(".modal-footer").html(v);s.find(".modal-footer #btn-overwrite").on("click",{action:"overwrite"},h);s.find(".modal-footer #btn-reload").on("click",{action:"show"},h)}else if(m&&m.val()=="confirm"){v+='<button type="button" class="btn btn-primary ew-btn">'+t.language.phrase("ConfirmBtn")+"</button>";v+='<button type="button" class="btn btn-default ew-btn">'+t.language.phrase("CancelBtn")+"</button>";s.find(".modal-footer").html(v);s.find(".modal-footer .btn-primary").click(h).focus();s.find(".modal-footer .btn-default").on("click",{action:"cancel"},h)}else{var E=o();if(E)v+='<button type="button" class="btn btn-primary ew-btn">'+E+"</button>";v+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>";s.find(".modal-footer").html(v);s.find(".modal-footer .btn-primary").addClass("ew-submit").click(h).focus()}Le(a,"ModalDialog");s.trigger("load.ew")}};var h=function(a){var i=s.find(".modal-body form")[0],r=e(i);var l=n[i.id];var o=a&&a.data?a.data.action:null;var u=a?a.target:null;if(u){l.enableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(u).prop("disabled",false).removeClass("disabled")};l.disableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(u).prop("disabled",true).addClass("disabled")}}var c=i.elements["action"];if(o&&c)c.value=o;if(o=="cancel"){e.post(r.attr("action"),r.serialize(),g).fail(d).always(f)}else if(l.canSubmit()){e.post(r.attr("action"),r.serialize(),p).fail(d)}return false};var g=function(a){var i=u(a);if(e.isObject(i)){if(i.error)H(i.error)}else{var r=s.data("args"),n=e(a),d=e(r.lnk),f="",c=o(),p=Pe(a);s.data("url",r.url);s.find(".modal-title").html(l());if(c)f+='<button type="button" class="btn btn-primary ew-btn">'+c+"</button>";if(f)f+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>";else f='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CloseBtn")+"</button>";s.find(".modal-footer").html(f);s.find(".modal-body").html(p);s.find(".modal-body form").keypress(function(e){if(e.which==13&&e.target.nodeName!="TEXTAREA")return h()});t.modalDialog=s.modal("show");s.find(".modal-dialog").addClass("table-"+d.data("table"));s.find(".modal-footer .btn-primary").addClass("ew-submit").click(h).focus();Le(a,"ModalDialog");s.trigger("load.ew")}};a.reload=false;if(s.data("showing")){var v=s.data("args");if(v){a.reload=v.reload;v.reload=false}else{s.data("args",{reload:false})}s.modal("hide")}s.data({args:a,showing:true,url:a.url});e("body").css("cursor","wait");var m=a.url;if(i&&r){e("<input>").attr({type:"hidden",name:"modal",value:"1"}).appendTo(r);e.post(m,r.serialize(),g).fail(d).always(f)}else{m+=(m.split("?").length>1?"&":"?")+"modal=1&rnd="+Et();e.get(m,g).fail(d).always(f)}}function Fe(a){var i=a.el,r=b(a.lnk);if(!r||!i)return;var s=t.modalLookupDialog||e("#ew-modal-lookup-dialog").on("hidden.bs.modal",Ue);if(s.data("showing"))return;s.data("showing",true);if(!s[0]){H("DIV #ew-modal-lookup-dialog not found.");return}var l=Ee(i,true),o=e(r),d=o.find("[id='"+i+"']"),f=s.find(".modal-body"),u=e(a.lnk),c=u.closest(".ew-lookup-list").find(".ew-lookup-text").focus();var p=Ee(i,false);var h="",g="",v=p.match(/^([xy])(\d*)_/);if(v){h=v[1];g=v[2]}var m=p.replace(/^([xy])(\d*)_/,"x_");var _=n[r.id].lists(m);var E=function(t){if(t.result=="OK"&&e.isArray(t.records)){e.each(t.records,function(a,i){var r;if(e.isArray(i))r={lf:i[0],df1:i[1],df2:i[2],df3:i[3],df4:i[4]};else if(e.isObject(i))r={lf:i.lf,df1:i.df,df2:i.df2,df3:i.df3,df4:i.df4};if(_.template){r["df"]=_.template.render(r);r["dv"]=Ae(i,d)}else{r["df"]=Ae(i,d);r["dv"]=r["df"]}t.records[a]=r})}};var A=function(e,t){if(!F(d))return;var a=B(d[0]);a._options[a._options.length]={val:e,lbl:t};a.input.value=t};var w=function(i){var n=[],s=[],l=[],o=[],u=!a.m&&a.srch;f.ewjtable("selectedRows").each(function(){var t=e(this).data("record");n.push(t.lf);s.push(t.df);l.push(t.df);o.push(t.dv)});if(i.sort().join()===n.sort().join()){c.html(Se(l,d.data("maxcount")));A(n.join(),o.join(", "));d.val(u?s.join(", "):n.join()).change()}else{var h=e.extend(true,{},_,{options:null,template:null,ajax:"modal",token:t.ANTIFORGERY_TOKEN,keys:i},T("#p_"+p,r));h[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;e.ajax(t.API_URL,{type:"POST",dataType:"json",data:h}).done(E).then(function(t){if(t.result=="OK"&&e.isArray(t.records)){var a=[],i=[],r=[],n=[],s=t.records;for(var l=0,o=s.length;l<o;l++){var f=s[l];a.push(f.lf);i.push(f.df);r.push(f.df);n.push(f.dv)}c.html(Se(r,d.data("maxcount")));A(a.join(),n.join(", "));d.val(u?i.join(", "):a.join()).change()}})}};var S=function(){w(C);s.modal("hide");return false};s.modal("hide");s.data("args",a);var I,O;var y=function(a){if(a.result=="OK"){s.find(".modal-title").html(u.attr("title")||u.data("original-title"));s.find(".modal-footer").html('<button type="button" id="btn-select" class="btn btn-primary ew-btn">'+t.language.phrase("SelectBtn")+"</button>"+'<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>");O=e('<input type="search" name="sv" class="form-control mb-2" placeholder="'+t.language.phrase("Search")+'">').prependTo(f).on("keyup",function(a){if(I)I.cancel();I=e.later(t.LOOKUP_DELAY,null,function(){f.ewjtable("load",{sv:O.val()})})});s.find(".modal-footer #btn-select").click(S);t.modalLookupDialog=s.modal("show");s.find("[name=sv]").focus()}else{H(a.message)}};var x=[];var L=d.val();var C=L!==""?L.split(t.LOOKUP_FILTER_VALUE_SEPARATOR):[];var R=e.extend(true,{},_,{options:null,template:null},T("#p_"+p,r));var N=_.parentFields.slice();if(g!=""){for(var P=0,M=N.length;P<M;P++){var D=N[P].split(" ");if(D.length==1)N[P]=N[P].replace(/^x_/,"x"+g+"_")}}if(N.length>0){for(var P=0,M=N.length;P<M;P++)x.push(ve(N[P],r))}for(var P=0,k=x.length;P<k;P++)R["v"+(P+1)]=x[P].join(t.LOOKUP_FILTER_VALUE_SEPARATOR);e("body").css("cursor","wait");f.ewjtable({paging:true,pageSize:a.n,pageSizes:[],pageSizeChangeArea:false,pageList:"minimal",selecting:true,selectingCheckboxes:true,multiselect:!!a.m,actions:{listAction:function(a,i){var r=e.extend({},R,{ajax:"modal",start:i.start,recperpage:i.recperpage,token:t.ANTIFORGERY_TOKEN});r[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;if(e.isObject(a))e.extend(r,a);return e.Deferred(function(a){e.ajax(t.API_URL,{type:"POST",dataType:"json",data:r,success:function(e){a.resolve(e)},error:function(){a.reject()}})}).done(E).always(function(){e("body").css("cursor","default")})}},messages:{serverCommunicationError:t.language.phrase("ServerCommunicationError"),loadingMessage:t.language.phrase("Loading"),noDataAvailable:t.language.phrase("NoRecord"),close:t.language.phrase("CloseBtn"),pagingInfo:t.language.phrase("Record")+" {0}-{1} "+t.language.phrase("Of")+" {2}",pageSizeChangeLabel:t.language.phrase("RecordsPerPage"),gotoPageLabel:t.language.phrase("Page")},fields:{lf:{key:true,list:false},df:{}},recordsLoaded:function(t,a){var i=e(t.target).find(".ewjtable-data-row").filter(function(){return C.includes(String(e(this).data("record-key")))});e(t.target).ewjtable("selectRows",i)},selectionChanged:function(t,i){var r=i.rows;if(r){if(!a.m)C=[];r.each(function(){var t=e(this);var a=String(t.data("record-key"));var i=C.indexOf(a);var r=t.hasClass("ewjtable-row-selected");if(r&&i==-1)C.push(a);else if(!r&&i>-1)C.splice(i,1)})}}}).ewjtable("load",null,y)}function Be(a){var i=t.importDialog||e("#ew-import-dialog");if(!i[0]){H("DIV #ew-import-dialog not found.");return}var r=i.find("#importfiles"),n=i.find(".modal-body"),s=n.find(":input[id!=importfiles]"),l=n.find(".message"),o=n.find(".progress"),d;var f=function(){i.find(".modal-footer .btn").prop("disabled",true)};var u=function(){i.find(".modal-footer .btn").prop("disabled",false)};var c=function(t,a){$msg=e("<div>"+t+"</div>");if(a)$msg.addClass(a);l.removeClass("d-none").html($msg);if(a=="text-danger")u()};var p=function(){l.addClass("d-none").html("")};var h=function(e,t){o.removeClass("d-none").find(".progress-bar").removeClass("bg-success bg-info").addClass(t||"bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%")};var g=function(){o.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%")};var v=function(e){var a=parseInt(100*e.loaded/e.total);h(a,"bg-info");if(a===100){c(t.language.phrase("ImportMessageUploadComplete"),"text-info")}else{c(t.language.phrase("ImportMessageUploadProgress").replace("%p",a),"text-info")}};var m=function(e){try{var a=parseInt(e.count),r=parseInt(e.totalCount),n=e.file;if(r>0&&i.find(".modal-footer .ew-close-btn").data("import-progress")){var s=parseInt(100*a/r);h(s);c(t.language.phrase("ImportMessageProgress").replace("%t",r).replace("%c",a).replace("%f",n),"text-info")}}catch(e){}};var _=function(t){if(e.isString(t)){try{t=e.parseJSON(t.trim())}catch(e){}}return t};var E=function(){var a=t.API_URL+"?"+t.API_ACTION_NAME+"="+t.API_PROGRESS_ACTION+"&rnd="+Et()+"&token="+r.data("token");e.get(a,m,"json")};var b=function(a){var r=5;var n="";h(100);var s=a.files;i.find(".modal-footer .ew-close-btn").data("import-progress",false);if(e.isArray(s)){for(var l=0,o=s.length;l<o;l++){var d=s[l],f=d.totalCount||0,u=d.count||0,p=d.successCount||0,v=d.failCount||0;if(n!="")n+="<br>";if(d.success){n+=t.language.phrase("ImportMessageSuccess").replace("%t",f).replace("%c",u).replace("%f",d.file)}else{n+=t.language.phrase("ImportMessageError1").replace("%t",f).replace("%c",u).replace("%f",d.file).replace("%s",p).replace("%e",v);if(d.error)n+=t.language.phrase("ImportMessageError2").replace("%e",d.error);var m=true;if(d.failList){var _=0;for(var l=1;l<=u;l++){if(d.failList["row"+l]){_+=1;n+="<br>"+t.language.phrase("ImportMessageError3").replace("%i",l).replace("%d",d.failList["row"+l])}if(_>=r)break}if(v>r)n+="<br>"+t.language.phrase("ImportMessageMore").replace("%s",v-r);else m=false}if(d.log&&m)n+="<br>"+t.language.phrase("ImportMessageError4").replace("%l",d.log);c(n,"text-danger")}}}if(a.success){c(n,"text-success");i.find(".modal-footer .ew-close-btn").data("imported",true)}else{if(a.error)n=a.error;c(n,"text-danger")}g()};var A=function(e){i.find(".modal-footer .ew-close-btn").data("import-progress",false);c(t.language.phrase("ImportMessageServerError").replace("%s",e.status).replace("%t",e.statusText),"text-danger")};var w=function(a){e("body").css("cursor","wait");r.data("token",a);i.find(".modal-footer .ew-close-btn").data("import-progress",true);var n=t.API_ACTION_NAME+"=import&token="+encodeURIComponent(t.ANTIFORGERY_TOKEN)+"&filetoken="+encodeURIComponent(a);if(s.length)n+="&"+s.serialize();e.ajax(We(),{data:n,method:"POST",dataType:"json",beforeSend:function(t,a){d=e.later(100,null,E,null,true)}}).done(b).fail(A).always(function(){e("body").css("cursor","default");if(d)d.cancel()})};var S={token:t.ANTIFORGERY_TOKEN,session:t.SESSION_ID};S[t.API_ACTION_NAME]=t.API_UPLOAD_ACTION;var T=t.importUploadOptions;if(!T.acceptFileTypes)T.acceptFileTypes=new RegExp("\\.("+t.IMPORT_FILE_ALLOWED_EXT.replace(/,/g,"|")+")$","i");if(!r.data("blueimpFileupload")){r.fileupload(e.extend({url:t.API_URL,dataType:"json",autoUpload:true,formData:S,singleFileUploads:false,messages:{acceptFileTypes:t.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:t.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:t.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:t.language.phrase("UploadErrMsgMinFileSize")},done:function(a,i){if(i.result&&i.result.files&&e.isArray(i.result.files.importfiles)){var r=true;e.each(i.result.files.importfiles,function(e,a){if(a.error){c(t.language.phrase("ImportMessageUploadError").replace("%f",a.name).replace("%s",a.error),"text-danger");r=false}});if(r)w(i.result.filetoken)}},change:function(e,t){p()},processfail:function(a,i){e.each(i.files,function(e,a){if(a.error)c(t.language.phrase("ImportMessageUploadError").replace("%f",a.name).replace("%s",a.error),"text-danger")})},fail:function(e,a){c(t.language.phrase("ImportMessageServerError").replace("%s",a.textStatus).replace("%t",a.errorThrown),"text-danger")},progressall:function(e,t){v(t)}},T))}i.modal("hide").find(".modal-title").html(a.hdr);i.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",function(){var t=e(this);if(t.data("imported")){t.data("imported",false);window.location.reload(true)}});p();t.importDialog=i.modal("show")}function He(a){var i=n(a).$element[0];if(!i)return;var r=ve(a);var s=Ee(a);var l="",o="",d=s.match(/^([xy])(\d*)_/);if(d){l=d[1];o=d[2]}var f=s.replace(/^([xy])(\d*)_/,"x_");var u=n(a).lists[f];var c=u.autoFillTargetFields;var p=function(t){var r=t&&t.records||"";var l=r?r[0]:[];for(var d=0;d<c.length;d++){var f=de(c[d].replace(/^x_/,"x"+o+"_"),i);if(f){var u=e.isValue(l["af"+d])?l["af"+d]:"";var p={results:r,result:l,data:u,form:i,name:s,target:c[d],cancel:false,trigger:true};e(a).trigger("autofill",[p]);if(p.cancel)continue;u=p.data;if(f.options||f.length&&f[0].type=="radio"){Oe(f,u.split(","))}else if(f.length&&f[0].type=="checkbox"){Oe(f,u.split(","))}else if(F(f)){f.value=u;B(f).input.value=u;S.call(n[i.id],f)}else if($(f)){f.value=u;S.call(n[i.id],f)}else if(U(f)){f.value=u;e(f).data("editor").set()}else{f.value=u}if(p.trigger)e(f).change()}}};if(r.length>0&&r[0]!=""){var h=e.extend(true,{},u,{template:null,options:null,ajax:"autofill",v0:r[0],token:t.ANTIFORGERY_TOKEN,language:t.LANGUAGE_ID},T("#p_"+s,i));var g=[];var v=u.parentFields.slice();if(o!=""){for(var m=0,_=v.length;m<_;m++){var r=v[m].split(" ");if(r.length==1)v[m]=v[m].replace(/^x_/,"x"+o+"_")}}if(v.length>0){for(var m=0,_=v.length;m<_;m++)g.push(ve(v[m],i))}for(var m=0,E=g.length;m<E;m++)h["v"+(m+1)]=encodeURIComponent(g[m].join(t.LOOKUP_FILTER_VALUE_SEPARATOR));h[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;e.post(t.API_URL,h,p,"json")}else{p()}}function je(a,i){var r=e(i),n=e("#"+r.data("tooltip-id")),s=r.data("trigger")||"hover",l=r.data("placement")||(t.CSS_FLIP?"left":"right");if(!n[0]||n.text().trim()==""&&!n.find("img[src!='']")[0])return;if(!r.data("bs.popover")){r.popover({html:true,placement:l,trigger:s,delay:100,container:e("#ew-tooltip")[0],content:n.html()}).on("show.bs.popover",function(t){var a,i=e(r.data("bs.popover").getTipElement()).css("z-index",9999);if(a=r.data("tooltip-width"))i.css("max-width",parseInt(a,10)+"px")})}}function Ge(a){var i=t.emailDialog||e("#ew-email-dialog");if(!i[0]){H("DIV #ew-email-dialog not found.");return}if(a.sel&&!V(a.f)){H(t.language.phrase("NoRecordSelected"));return}var r=i.find(".modal-body form");var n=r.data("form");if(!n){n=new m(r.attr("id"));n.validate=function(){var e,a=this.getForm();e=a.elements["sender"];if(e&&!Y(e))return this.onError(e,t.language.phrase("EnterSenderEmail"));if(e&&!ht(e.value,1))return this.onError(e,t.language.phrase("EnterProperSenderEmail"));e=a.elements["recipient"];if(e&&!Y(e))return this.onError(e,t.language.phrase("EnterRecipientEmail"));if(e&&!ht(e.value,t.MAX_EMAIL_RECIPIENT))return this.onError(e,t.language.phrase("EnterProperRecipientEmail"));e=a.elements["cc"];if(e&&!ht(e.value,t.MAX_EMAIL_RECIPIENT))return this.onError(e,t.language.phrase("EnterProperCcEmail"));e=a.elements["bcc"];if(e&&!ht(e.value,t.MAX_EMAIL_RECIPIENT))return this.onError(e,t.language.phrase("EnterProperBccEmail"));e=a.elements["subject"];if(e&&!Y(e))return this.onError(e,t.language.phrase("EnterSubject"));return true};n.submit=function(){if(!this.validate())return false;var t=r.serialize(),n="";if(a.f&&a.sel)n=e(a.f).find("input[type=checkbox][name='key_m[]']:checked").serialize();if(a.key)t+="&"+e.param(a.key);var s=this.getForm();if(a.url){i.modal("hide");D(a.f,a.url,"email",true,a.sel,s)}else{e.post(e(a.f).attr("action"),t+"&"+n,function(e){_t(e)})}return true};r.data("form",n)}i.modal("hide").find(".modal-title").html(a.hdr);i.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault();if(n.submit())i.modal("hide")});t.emailDialog=i.modal("show")}function Ye(a,i){if(!e.isObject(a))return undefined;var r=a.action;if(!r)return undefined;var n=e.extend({token:t.ANTIFORGERY_TOKEN},a);var s=function(t){if(e.isObject(t)&&t.result=="OK"){var a=t.records;if(e.isArray(a)&&a.length==1){a=a[0];if(e.isArray(a)&&a.length==1)return a[0];else return a}return a}};if(e.isFunction(i)){e.post(t.API_URL,n,function(e){i(s(e))},"json")}else{var l=e.ajax({url:t.API_URL,async:false,type:"POST",data:n}).responseText;l=e.parseJSON(l);return s(l)}}function We(){return location.href.split("#")[0].split("?")[0]}function ze(e,t){var a=this.form.elements[e];if(!a)return;a.value=a.value!=t?t:"="}function Ve(e){return et(e,"us",t.DATE_SEPARATOR)}function Ke(e){return et(e,"usshort",t.DATE_SEPARATOR)}function Xe(e){return et(e,"std",t.DATE_SEPARATOR)}function qe(e){return et(e,"stdshort",t.DATE_SEPARATOR)}function Je(e){return et(e,"euro",t.DATE_SEPARATOR)}function Qe(e){return et(e,"euroshort",t.DATE_SEPARATOR)}function Ze(e){if(t.DATE_FORMAT.match(/^yyyy/))return Xe(e);else if(t.DATE_FORMAT.match(/^yy/))return qe(e);else if(t.DATE_FORMAT.match(/^m/)&&t.DATE_FORMAT.match(/yyyy$/))return Ve(e);else if(t.DATE_FORMAT.match(/^m/)&&t.DATE_FORMAT.match(/yy$/))return Ke(e);else if(t.DATE_FORMAT.match(/^d/)&&t.DATE_FORMAT.match(/yyyy$/))return Je(e);else if(t.DATE_FORMAT.match(/^d/)&&t.DATE_FORMAT.match(/yy$/))return Qe(e);return false}function et(e,t,a){if(!e||e.length=="")return true;e=e.replace(/ +/g," ");e=e.replace(/^\s*|\s*$/g,"");var i=e.split(" ");if(i.length>0){var r,n,s,l,o;r=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1])$/;if(n=r.exec(i[0])){s=n[1];l=n[2];o=n[3]}else{var d="\\"+a;switch(t){case"std":r=new RegExp("^(\\d{4})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"stdshort":r=new RegExp("^(\\d{2})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"us":r=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{4})$");break;case"usshort":r=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{2})$");break;case"euro":r=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{4})$");break;case"euroshort":r=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{2})$");break}if(!r.test(i[0]))return false;var f=i[0].split(a);switch(t){case"std":case"stdshort":s=tt(f[0]);l=f[1];o=f[2];break;case"us":case"usshort":s=tt(f[2]);l=f[0];o=f[1];break;case"euro":case"euroshort":s=tt(f[2]);l=f[1];o=f[0];break}}if(!at(s,l,o))return false}if(i.length>1&&!dt(i[1]))return false;return true}function tt(e){if(e.length==2)return e>t.UNFORMAT_YEAR?"19"+e:"20"+e;return e}function at(e,t,a){e=parseInt(e,10);t=parseInt(t,10);a=parseInt(a,10);var i=[4,6,9,11].includes(t)?30:31;if(t==2)i=e%4>0||e%100==0&&e%400>0?28:29;return ot(a,1,i)}function it(e){if(!e||e.length==0)return true;if(e.indexOf(t.DECIMAL_POINT)>-1)return false;return rt(e)}function rt(e){e=String(e);if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var a=new RegExp("^[+-]?(\\d{1,3}("+(t.THOUSANDS_SEP?"\\"+t.THOUSANDS_SEP+"?":"")+"\\d{3})*(\\"+t.DECIMAL_POINT+"\\d+)?|\\"+t.DECIMAL_POINT+"\\d+)$");return a.test(e)}function nt(e){e=String(e);if(t.THOUSANDS_SEP!=""){var a=new RegExp("\\"+t.THOUSANDS_SEP,"g");e=e.replace(a,"")}if(t.DECIMAL_POINT!="")e=e.replace(t.DECIMAL_POINT,".");return parseFloat(e)}function st(e){var t=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/;var a=e.replace(t,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5])}function lt(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function ot(t,a,i){if(!t||t.length==0)return true;if(e.isNumber(a)||e.isNumber(i)){if(rt(t))t=nt(t)}if(!e.isNull(a)&&t<a)return false;if(!e.isNull(i)&&t>i)return false;return true}function dt(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var a=new RegExp("^(0\\d|1\\d|2[0-3])"+lt(t.TIME_SEPARATOR)+"[0-5]\\d(( ("+lt(t.language.phrase("AM"))+"|"+lt(t.language.phrase("PM"))+"))|("+lt(t.TIME_SEPARATOR)+"[0-5]\\d(\\.\\d+)?)?)$","i");return a.test(e)}function ft(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/;return t.test(e)}function ut(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\d{5}$|^\d{5}-\d{4}$/;return t.test(e)}function ct(e){if(!e||e.length==0)return true;var t=e.replace(/\D/g,"");if(t.length==0)return false;var a=t.length%2==1?false:true;var i,r=0;for(var n=0,s=t.length;n<s;n++){i=parseInt(t.charAt(n),10);if(a){i*=2;r+=i%10;if(i/10>=1)r++;a=false}else{r+=i;a=true}}return r%10==0}function pt(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/;return t.test(e)}function ht(e,t){if(!e||e.length==0)return true;var a=e.replace(/,/g,";").split(";");for(var i=0,r=a.length;i<r;i++){if(t>0&&r>t)return false;if(!gt(a[i]))return false}return true}function gt(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i;return t.test(e)}function vt(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/;var a=/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/;return t.test(e)||a.test(e)}function mt(e,t){if(!e||e.length==0)return true;return!!e.match(t)}function _t(a){if(window.location!=window.parent.location&&parent.showMessage)return parent.showMessage(a);var i=a&&a.target?a.target:document,r=e(i).find("div.ew-message-dialog:hidden:first");e.each(["success","info","warning","danger"],function(e,t){r.find(".alert-"+t).toggleClass("alert-"+t+" text-"+t)});var n=e.isString(a)?a:r.length?t.IS_MOBILE?r.text():r.html():"";if(n.trim()=="")return;if(t.IS_MOBILE){alert(n)}else{var s=e("#ew-message-box");s.find(".modal-body").html(n);s.modal("show")}}function Et(){return Math.floor(Math.random()*100001)+1e5}function bt(a){var i=e(a);if(i.data("blueimpFileupload"))return;var r=i.attr("name"),n=r.replace(/\$/g,"\\$"),s=i.data("table"),l=i.is("[multiple]"),o=i.closest(".form-group,[id^='el_']"),d=o.find(".btn").css("display")=="none"||i.closest("form").find("#confirm").val()=="F",f=o.find("#ft_"+n),u=o.find("#fn_"+n),c=o.find("#fa_"+n),p=o.find("#fs_"+n),h=o.find("#fx_"+n),g=o.find("#fm_"+n),v=o.find("#fc_"+n);var m=function(e,a){if(a.result.files[0].error)return;var i=a.result.files[0].name;var r=l?u.val()?u.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[]:[];r[r.length]=i;u.val(r.join(t.MULTIPLE_UPLOAD_SEPARATOR));c.val("0");if(!l)f.find("tr:not(:last)").remove()};var _=function(a,i){var r={},n=e(a.originalEvent.target).data("url");if(n)n.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,a){if(t)r[t]=a});var s=r["id"];if(s&&r[s]){var l=r[s];var o=u.val()?u.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[];e.each(o,function(e,t){if(t==decodeURIComponent(l)){o.splice(e,1);return false}});u.val(o.join(t.MULTIPLE_UPLOAD_SEPARATOR));c.val("0")}};var E=function(a,i){var r=u.val()?u.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[];for(var n=0;n<i.files.length;n++)r[r.length]=i.files[n].name;var s=parseInt(v.val(),10);if(e.isNumber(s)&&s>0&&r.length>s){H(t.language.phrase("UploadErrMsgMaxNumberOfFiles"));return false}var l=parseInt(p.val(),10);if(e.isNumber(l)&&l>0&&r.join(t.MULTIPLE_UPLOAD_SEPARATOR).length>l){H(t.language.phrase("UploadErrMsgMaxFileLength"));return false}};var A=function(e){if(!l&&u.val()){if(!confirm(t.language.phrase("UploadOverwrite"))){e.preventDefault();e.stopPropagation()}}};var w=function(a){var i=e();e.each(a.files,function(r,n){var s=e('<tr class="template-upload">'+'<td class="preview"></td>'+'<td class="name"></td>'+'<td class="size"></td>'+(n.error?'<td class="error text-danger" colspan="2"></td>':'<td><div class="progress">'+'<div class="progress-bar bg-success" style="width: 0%;"></div></div></td>'+'<td><button type="button" class="btn btn-default btn-sm start">'+t.language.phrase("UploadStart")+"</button></td>")+'<td><button type="button" class="btn btn-default btn-sm cancel">'+t.language.phrase("UploadCancel")+"</button></td></tr>");s.find(".name").text(n.name);s.find(".size").text(a.formatFileSize(n.size));s.find(".start").click(A);s.find(".error").text(n.error);i=i.add(s)});return i};var S=function(a){var i=e();e.each(a.files,function(r,n){var s=e('<tr class="template-download">'+(n.error?'<td></td><td class="name"></td>'+'<td class="size"></td><td class="error text-danger" colspan="2"></td>':'<td class="preview"></td>'+'<td class="name"><a></a></td>'+'<td class="size"></td><td colspan="2"></td>')+(d?"":'<td><button type="button" class="btn btn-default btn-sm delete">'+t.language.phrase("UploadDelete")+"</button></td>")+"</tr>");s.find(".size").text(a.formatFileSize(n.size));if(n.error){s.find(".name").text(n.name);s.find(".error").text(n.error);if(!n.deleteUrl)s.find(".delete").click(function(){e(this).closest(".template-download").remove();T()})}else{var l=s.find(".name a").text(n.name);if(n.url)l.attr("href",n.url).attr("target","_blank");if(n.thumbnailUrl&&/\.(bmp|gif|jpe?g|png)$/i.test(n.name)){if(t.USE_COLORBOX)l.colorbox(t.lightboxSettings);s.find(".preview").append('<img style="width: '+t.UPLOAD_THUMBNAIL_WIDTH+'px;">').find("img").prop("src",n.thumbnailUrl)}else if(n.url&&/\.(mp4)$/i.test(n.name)){s.find(".preview").append('<video style="width: '+t.UPLOAD_THUMBNAIL_WIDTH+'px;" controls><source type="video/mp4"></video>').find("source").prop("src",n.url)}else if(n.url&&/\.(mp3)$/i.test(n.name)){s.find(".preview").append('<audio style="width: '+t.UPLOAD_THUMBNAIL_WIDTH+'px;" controls><source type="audio/mpeg"></audio>').find("source").prop("src",n.url)}s.find(".delete").attr("data-type",n.deleteType).attr("data-url",n.deleteUrl)}i=i.add(s)});return i};var T=function(){f.css("margin-top",f.find("tr")[0]&&!d?"10px":"0")};var I=function(){i.closest("span.fileinput-button").tooltip("hide")};var O=function(e,t){if(t.files&&t.files.error)H(t.files[0].error)};var y=b(a),x=e(y);var L=x.find("#confirm").val()=="F";if(L)x.find("span.fileinput-button").hide();var C=parseInt(v.val(),10);var R=t.UPLOAD_URL;var N={id:r,table:s,session:t.SESSION_ID,replace:l?"0":"1",exts:h.val(),maxsize:g.val(),maxfilecount:v.val()};N[t.API_ACTION_NAME]=t.API_JQUERY_UPLOAD_ACTION;if(pe(t.UPLOAD_TYPE,"PUT"))R+="?"+e.param(N);i.fileupload({url:R,type:t.UPLOAD_TYPE,multipart:pe(t.UPLOAD_TYPE,"POST"),autoUpload:true,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/(mp4)$/i,loadAudioFileTypes:/^audio\/(mpeg)$/i,acceptFileTypes:h.val()?new RegExp("\\.("+h.val().replace(/,/g,"|")+")$","i"):null,maxFileSize:parseInt(g.val(),10),maxNumberOfFiles:C>1?C:null,filesContainer:f,formData:N,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:w,downloadTemplate:S,previewMaxWidth:t.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:t.UPLOAD_THUMBNAIL_HEIGHT,dropZone:o,pasteZone:o,messages:{acceptFileTypes:t.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:t.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:t.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:t.language.phrase("UploadErrMsgMinFileSize")}}).on("fileuploaddone",m).on("fileuploaddestroy",_).on("fileuploadchange",E).on("fileuploadadded fileuploadfinished fileuploaddestroyed",T).on("fileuploadprocessfail",O).click(I);if(u.val()){var P={id:r,table:s,session:t.SESSION_ID};P[t.API_ACTION_NAME]=t.API_JQUERY_UPLOAD_ACTION;e.ajax({url:R,data:P,dataType:"json",context:this,success:function(t){if(t&&t[r]){var n=i.fileupload("option","done");if(n)n.call(a,e.Event(),{result:{files:t[r]}})}if(L)f.find("td.delete").hide()}})}}function At(a,i){if(e.isString(a)){i=i||{thousandsSeparator:t.THOUSANDS_SEP,decimalSeparator:t.DECIMAL_POINT};var r=[],n,s=i.thousandsSeparator,l=i.decimalSeparator;if(s)r.push(s.replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")+"(?=\\d)");n=new RegExp("(?:"+r.join("|")+")","g");if(l===".")l=null;a=a.replace(n,"");a=l?a.replace(l,"."):a}if(e.isString(a)&&a.trim()!=="")a=+a;if(!e.isNumber||!isFinite(a))a=null;return a}function wt(a,i){if(e.isNumber(a)){i=i||{thousandsSeparator:t.THOUSANDS_SEP,decimalSeparator:t.DECIMAL_POINT};var r=a<0,n=a+"",s=i.decimalPlaces,l=i.decimalSeparator||".",o=i.thousandsSeparator,d,f,u,c;if(e.isNumber(s)&&s>=0&&s<=20)n=a.toFixed(s);if(l!==".")n=n.replace(".",l);if(o){d=n.lastIndexOf(l);d=d>-1?d:n.length;f=n.substring(d);for(u=0,c=d;c>0;c--){if(u%3===0&&c!==d&&(!r||c>1))f=o+f;f=n.charAt(c-1)+f;u++}n=f}return n}else{return e.isValue(a)&&a.toString?a.toString():""}}function St(a,i){var r=e.makeArray(arguments);if(e.isNumber(i)&&i>=0&&i<=17){var n,s=t.DATE_FORMAT.toUpperCase(),l=t.DATE_SEPARATOR,o=t.TIME_SEPARATOR;switch(i){case 0:case 1:case 2:case 8:n=s+" HH"+o+"mm"+o+"ss";break;case 3:n="hh:mm:ss A";break;case 4:n="HH:mm:ss";break;case 5:n="YYYY"+l+"MM"+l+"DD";break;case 6:n="MM"+l+"DD"+l+"YYYY";break;case 7:n="DD"+l+"MM"+l+"YYYY";break;case 9:n="YYYY"+l+"MM"+l+"DD HH"+o+"mm"+o+"ss";break;case 10:n="MM"+l+"DD"+l+"YYYY HH"+o+"mm"+o+"ss";break;case 11:n="DD"+l+"MM"+l+"YYYY HH"+o+"mm"+o+"ss";break;case 12:n="YY"+l+"MM"+l+"DD";break;case 13:n="MM"+l+"DD"+l+"YY";break;case 14:n="DD"+l+"MM"+l+"YY";break;case 15:n="YY"+l+"MM"+l+"DD HH"+o+"mm"+o+"ss";break;case 16:n="MM"+l+"DD"+l+"YY HH"+o+"mm"+o+"ss";break;case 17:n="DD"+l+"MM"+l+"YY HH"+o+"mm"+o+"ss";break}r[1]=[n,"YYYY-MM-DD HH"+o+"mm"+o+"ss"]}return moment.apply(this,r)}function Tt(e,a){return moment(e).format(a||t.DATE_FORMAT.toUpperCase())}function It(a){x(a);_(a);v(a);d(a);o(a);g(a);var i=a&&a.target?a.target:document,r=e(i);r.find("[data-widget='treeview']").each(function(){adminlte.Treeview._jQueryInterface.call(e(this),"init")});r.find("table."+t.TABLE_CLASSNAME+":not(.ew-export-table):not(#"+t.REPORT_CONTAINER_ID+" table)").each(ae);r.find("table."+t.GRID_CLASSNAME+":not(.ew-export-table):not(#"+t.REPORT_CONTAINER_ID+" table)").each(ie);r.find(".ew-btn-dropdown").on("shown.bs.dropdown",function(){var t=e(this).removeClass("dropup"),a=e(window);$menu=t.find("> .dropdown-menu");t.toggleClass("dropup",$menu.offset().top+$menu.height()>a.scrollTop()+a.height())});r.find("input[name=pageno]").keypress(function(e){if(e.which==13){var t=window.location.href,a=t.lastIndexOf(window.location.search);window.location=t.substr(0,a)+"?"+this.name+"="+parseInt(this.value);return false}});if(!t.IS_SCREEN_SM_MIN){r.find(".table-responsive [data-toggle='dropdown']").parent().on("shown.bs.dropdown",function(){var a=e(this),i=a.find(".dropdown-menu"),r=a.closest(".table-responsive")[0];if(r.scrollHeight-r.clientHeight){var n=i.offset().top+i.outerHeight()-e(r).offset().top-r.clientHeight;if(n>0)i.css(t.CSS_FLIP?"right":"left","100%").css("top",parseFloat(i.css("top"))-n)}})}h(a);u(a);c(a);if(typeof t.USE_JAVASCRIPT_MESSAGE!="undefined"&&t.USE_JAVASCRIPT_MESSAGE)_t(a)}function Ot(){e(".sidebar").slimScroll({height:e(".main-sidebar").css("min-height")})}e(window).off("load.lte.treeview");var yt=adminlte.Layout,xt=adminlte.Treeview,Lt,Ct;function Rt(){if(!Lt)Lt=e(".wrapper");return Lt}function Nt(){return Rt().prop("offsetHeight")>Rt().prop("clientHeight")}function Pt(){return Rt().prop("offsetWidth")>Rt().prop("clientWidth")}function Mt(){e("html").css("overflow-y",Pt()?"hidden":"auto")}if(!t.RESET_HEIGHT){yt.prototype._fixLayoutHeight=yt.prototype.fixLayoutHeight;yt.prototype.__init=yt.prototype._init;yt.prototype.fixLayoutHeight=function(){var t=e(".main-sidebar").css("height","auto"),a=e(".content-wrapper").css("height","auto"),i=e(".main-footer").removeClass("show"),r={window:e(window).height(),header:e(".main-header").outerHeight(),footer:i.outerHeight(),sidebar:t.height()},n=this._max(r),s=n-r.header-r.footer,l=a.height();a.css("min-height",s);if(l<=s)a.css("height",s);var o=Rt().prop("clientHeight");if(Nt()){t.css({"min-height":o,height:o})}else{t.css({"min-height":n-r.header,height:o})}Mt();i.addClass("show");Ot()};yt.prototype._init=function(){this.__init();if(Nt()){e("html, body, .wrapper").css("height","100%");this.fixLayoutHeight()}}}else{yt.prototype._fixLayoutHeight=yt.prototype.fixLayoutHeight;yt.prototype.fixLayoutHeight=function(){this._fixLayoutHeight();Ot()}}function Dt(){if(Ct)Ct.cancel();Ct=e.later(50,null,function(){if(Nt())e("html, body, .wrapper").css("height","100%");Mt();var t=e("body").data("lte.layout");if(t)t.fixLayoutHeight()})}xt.prototype._toggle=xt.prototype.toggle;xt.prototype.toggle=function t(a){var i=e(a.currentTarget),r=i.next(),n=i.attr("href"),s=e(a.target);if(!r.is(".nav-treeview")||s.is("span:not(.right)")&&n&&n!="#"&&n!="javascript:void(0);")return;this._toggle(a)};e(function(){e.views.settings.debugMode(t.DEBUG_ENABLED);f();It();e("#ew-modal-dialog").on("load.ew",It);e("#ew-add-opt-dialog").on("load.ew",It);var a=N("hash");if(a&&a.length)e("html, body").animate({scrollTop:e("#"+a[0]).offset().top},800)});a.on("addoption",function(t,a){var i=a.data;var r=a.parents;for(var n=0,s=r.length;n<s;n++){var l=r[n];if(!l.length)return a.valid=false;var o=i["ff"+(n>0?n+1:"")];if(!e.isUndefined(o)&&!l.includes(String(o)))return a.valid=false}});a.on("show.bs.modal",".modal",function(){var t=9900+10*e(".modal:visible").length;e(this).css("z-index",t);setTimeout(function(){e(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")},0)});a.on("hidden.bs.modal",".modal",function(){e(".modal:visible").length&&e(document.body).addClass("modal-open")});return{IS_MOBILE:i,getAutoSuggestSettings:s,setAutoSuggestSettings:l,forms:n,initIcons:o,initPasswordOptions:d,setSessionTimer:f,initExportLinks:u,initMultiSelectCheckboxes:c,fileDownload:p,lazyLoad:h,initLightboxes:g,initTooltips:v,Form:m,Language:I,prompt:E,getForm:b,hasFormData:A,setSearchType:w,updateOptions:S,getUserParams:T,applyTemplate:O,renderTemplate:y,renderJsTemplates:x,showTemplates:L,convertToBool:C,valueChanged:R,get:N,setLanguage:P,submitAction:M,export:D,removeSpaces:k,isHiddenTextArea:U,isModalLookup:$,isAutoSuggest:F,getAutoSuggest:B,alert:H,onError:j,setFocus:G,hasValue:Y,sort:W,confirmDelete:z,keySelected:V,selectAllKey:K,selectAll:X,updateSelected:q,setColor:J,clearSelected:Q,clearDelete:Z,clickDelete:ee,clickMultiCheckbox:te,setupTable:ae,setupGrid:ie,addGridRow:re,deleteGridRow:ne,htmlEncode:se,clearForm:le,MultiPage:oe,getElements:de,getElement:fe,getAncestorBy:ue,isHidden:ce,sameText:pe,sameString:he,inArray:ge,getOptionValues:ve,getOptionTexts:me,clearOptions:_e,getId:Ee,valueSeparator:be,displayValue:Ae,optionHtml:we,optionsHtml:Se,newOption:Te,renderOption:Ie,selectOption:Oe,AutoSuggest:xe,executeScript:Le,stripScript:Ce,addScript:Re,removeScript:Ne,getContent:Pe,saveOptions:Me,getOptions:De,addOptionDialogShow:ke,modalDialogHide:Ue,modalDialogShow:$e,modalLookupShow:Fe,importDialogShow:Be,autoFill:He,tooltip:je,emailDialogShow:Ge,ajax:Ye,currentPage:We,toggleSearchOperator:ze,checkUSDate:Ve,checkShortUSDate:Ke,checkDate:Xe,checkShortDate:qe,checkEuroDate:Je,checkShortEuroDate:Qe,checkDateDef:Ze,checkDateEx:et,unformatYear:tt,checkDay:at,checkInteger:it,checkNumber:rt,stringToFloat:nt,stringToDate:st,escapeRegExChars:lt,checkRange:ot,checkTime:dt,checkPhone:ft,checkZip:ut,checkCreditCard:ct,checkSsc:pt,checkEmails:ht,checkEmail:gt,checkGuid:vt,checkByRegEx:mt,showMessage:_t,random:Et,upload:bt,parseNumber:At,formatNumber:wt,parseDate:St,formatDate:Tt,updateSlimScroll:Ot,fixLayoutHeight:Dt,setOverflowY:Mt,Layout:yt}}(jQuery,ew));if(!String.prototype.includes){String.prototype.includes=function(e,t){"use strict";if(typeof t!=="number"){t=0}if(t+e.length>this.length){return false}else{return this.indexOf(e,t)!==-1}}}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}}if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){if(!(t<this.length))t=this.length;else t|=0;return this.substr(t-e.length,e.length)===e}}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var a=Object(this);var i=a.length>>>0;if(i===0){return false}var r=t|0;var n=Math.max(r>=0?r:i-Math.abs(r),0);function s(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(n<i){if(s(a[n],e)){return true}n++}return false}})}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){var a;if(this==null){throw new TypeError('"this" is null or not defined')}var i=Object(this);var r=i.length>>>0;if(r===0){return-1}var n=t|0;if(n>=r){return-1}a=Math.max(n>=0?n:r-Math.abs(n),0);while(a<r){if(a in i&&i[a]===e){return a}a++}return-1}}jQuery.extend({isBoolean:function(e){return typeof e==="boolean"},isNull:function(e){return e===null},isNumber:function(e){return typeof e==="number"&&isFinite(e)},isObject:function(e){return e&&(typeof e==="object"||this.isFunction(e))||false},isString:function(e){return typeof e==="string"},isUndefined:function(e){return typeof e==="undefined"},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return this.type(e)==="date"&&e.toString()!=="Invalid Date"&&!isNaN(e)},later:function(e,t,a,i,r){e=e||0;t=t||{};var n=a,s=i,l,o;if(this.isString(a))n=t[a];if(!n)return;if(!this.isUndefined(i)&&!this.isArray(s))s=[i];l=function(){n.apply(t,s||[])};o=r?setInterval(l,e):setTimeout(l,e);return{interval:r,cancel:function(){if(this.interval){clearInterval(o)}else{clearTimeout(o)}}}}});(function(e,t){e.fn.fields=function(a){var i={},r=this.attr("id"),n=this[0],s,l,o;if(/^[xy](\d*)_/.test(r)){s=t.getForm(n);l=this.data("table");o=RegExp.$1}else if(n&&n._form){s=n.$element;l=n.id.replace(new RegExp("^f|"+n.pageId+"$","g"),"");o=e(n._form).data("rowindex")}var d="[data-table="+l+"][data-field"+(a?"=x_"+a:"")+"]";if(e.isValue(o))d+="[name^=x"+o+"_]";if(s&&d){e(s).find(d).each(function(){var t=this.getAttribute("data-field").substr(2),a=this.getAttribute("name");t=/^y_/.test(a)?"y_"+t:t;i[t]=i[t]?i[t].add(this):e(this)})}return a?i[a]:i};e.fn.extend({row:function(){var e=this.closest("#r_"+this.data("field").substr(2));if(!e[0])e=this.closest(".ew-table > tbody > tr");return e},visible:function(e){var t=this.closest("#r_"+this.data("field").substr(2));if(!t[0])t=this.closest("span[id^=el_]");if(typeof e!="undefined"){t.toggle(e);return this}else{return t.is(":visible")}},readonly:function(e){if(typeof e!="undefined"){this.prop("readOnly",e);return this}else{return this.prop("readOnly")}},disabled:function(e){if(typeof e!="undefined"){this.prop("disabled",e);return this}else{return this.prop("disabled")}},value:function(a){var i=this.attr("type");if(typeof a!="undefined"){if(!e.isArray(a))a=[a];var i=this.attr("type");var r=i=="radio"||i=="checkbox"?this.get():this[0];t.selectOption(r,a);return this}else{if(i=="checkbox"){return t.getOptionValues(this.get())}else if(i=="radio"){return t.getOptionValues(this.get()).join()}else if(t.isHiddenTextArea(this)){this.data("editor").save();return this.val()}else{return this.val()}}},toNumber:function(){return t.parseNumber(this.value())},toDate:function(){return t.parseDate(this.value(),this.data("format"))},toJsDate:function(){return t.parseDate(this.value(),this.data("format")).toDate()}})})(jQuery,ew);(function(e,t){e(document).on("click.bs.dropdown.data-api",".ew-dropdown[data-toggle=dropdown]",function(a){var i=a.target.nodeName;var r=e(this).attr("href");if(r&&r!="#"&&window.matchMedia){if(t.IS_SCREEN_SM_MIN||i=="SPAN"){window.location=r}}})})(jQuery,ew);ewVar=ew.vars;